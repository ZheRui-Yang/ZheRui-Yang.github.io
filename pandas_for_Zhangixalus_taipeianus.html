<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh-TW" xml:lang="zh-TW">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.5, user-scalable=yes" />
  <meta name="author" content="Zhe-Rui, Yang" />
  <title>台北樹蛙也能懂的 — Pandas</title>
  <link rel="stylesheet" href="./css/aws-rek.css" />
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" type="text/javascript"></script>
</head>
<body>
<header id="title-block-header">
<h1 class="title">台北樹蛙也能懂的 — Pandas</h1>
</header>
<nav id="TOC" role="doc-toc">
<h2 id="toc-title">Contents</h2>
<ul>
<li><a href="#pandas-台北動物園裡的那個嗎">Pandas ？台北動物園裡的那個嗎？</a></li>
<li><a href="#真正開始之前">真正開始之前…</a>
<ul>
<li><a href="#安裝與匯入">安裝與匯入</a></li>
</ul></li>
<li><a href="#適用於-pandas-的資料長怎樣">適用於 Pandas 的資料長怎樣？</a></li>
<li><a href="#我能從檔案讀取資料嗎">我能從檔案讀取資料嗎？</a></li>
<li><a href="#我要怎麼觀察我的資料">我要怎麼觀察我的資料？</a>
<ul>
<li><a href="#初步觀察與元資料-metadata">初步觀察與元資料（ metadata ）</a></li>
<li><a href="#我只想看中間一部分而已">我只想看中間一部分而已</a></li>
<li><a href="#一點小小的統計也許有用">一點小小的統計也許有用</a></li>
<li><a href="#我要怎麼過濾出我要的資料就好">我要怎麼過濾出我要的資料就好？</a></li>
<li><a href="#透視表-pivot-table-又稱樞紐分析要怎麼做">透視表（ pivot table ，又稱樞紐分析）要怎麼做？</a></li>
<li><a href="#還是很難理解全局動向我可以畫圖嗎">還是很難理解全局動向，我可以畫圖嗎？</a></li>
</ul></li>
<li><a href="#原始表格不符需求我要怎麼改動它">原始表格不符需求，我要怎麼改動它？</a>
<ul>
<li><a href="#我要怎麼刪除或新增我需要的欄位">我要怎麼刪除或新增我需要的欄位？</a></li>
<li><a href="#中文英文一直來回切換好麻煩喔我要重新命名欄位名稱">中文英文一直來回切換好麻煩喔！我要重新命名欄位名稱</a></li>
<li><a href="#我要怎麼用自定義函式改動欄位">我要怎麼用自定義函式改動欄位？</a></li>
<li><a href="#我要怎麼合併兩張表">我要怎麼合併兩張表？</a></li>
</ul></li>
<li><a href="#聽說-pandas-對時間日期的分析很方便">聽說 Pandas 對時間日期的分析很方便？</a></li>
<li><a href="#文字資料也能輕鬆操作">文字資料也能輕鬆操作？</a></li>
<li><a href="#你可能還會想看">你可能還會想看…</a></li>
</ul>
</nav>
<nav id="SideTOC" role="doc-toc">
<h2 id="toc-title">Contents</h2>
<ul>
<li><a href="#pandas-台北動物園裡的那個嗎">Pandas ？台北動物園裡的那個嗎？</a></li>
<li><a href="#真正開始之前">真正開始之前…</a>
<ul>
<li><a href="#安裝與匯入">安裝與匯入</a></li>
</ul></li>
<li><a href="#適用於-pandas-的資料長怎樣">適用於 Pandas 的資料長怎樣？</a></li>
<li><a href="#我能從檔案讀取資料嗎">我能從檔案讀取資料嗎？</a></li>
<li><a href="#我要怎麼觀察我的資料">我要怎麼觀察我的資料？</a>
<ul>
<li><a href="#初步觀察與元資料-metadata">初步觀察與元資料（ metadata ）</a></li>
<li><a href="#我只想看中間一部分而已">我只想看中間一部分而已</a></li>
<li><a href="#一點小小的統計也許有用">一點小小的統計也許有用</a></li>
<li><a href="#我要怎麼過濾出我要的資料就好">我要怎麼過濾出我要的資料就好？</a></li>
<li><a href="#透視表-pivot-table-又稱樞紐分析要怎麼做">透視表（ pivot table ，又稱樞紐分析）要怎麼做？</a></li>
<li><a href="#還是很難理解全局動向我可以畫圖嗎">還是很難理解全局動向，我可以畫圖嗎？</a></li>
</ul></li>
<li><a href="#原始表格不符需求我要怎麼改動它">原始表格不符需求，我要怎麼改動它？</a>
<ul>
<li><a href="#我要怎麼刪除或新增我需要的欄位">我要怎麼刪除或新增我需要的欄位？</a></li>
<li><a href="#中文英文一直來回切換好麻煩喔我要重新命名欄位名稱">中文英文一直來回切換好麻煩喔！我要重新命名欄位名稱</a></li>
<li><a href="#我要怎麼用自定義函式改動欄位">我要怎麼用自定義函式改動欄位？</a></li>
<li><a href="#我要怎麼合併兩張表">我要怎麼合併兩張表？</a></li>
</ul></li>
<li><a href="#聽說-pandas-對時間日期的分析很方便">聽說 Pandas 對時間日期的分析很方便？</a></li>
<li><a href="#文字資料也能輕鬆操作">文字資料也能輕鬆操作？</a></li>
<li><a href="#你可能還會想看">你可能還會想看…</a></li>
</ul>
</nav>
<span id="change-point"></span>

<svg id="toc-button" width="104" height="124" onclick="sideTOCOn();">
  <rect x="2" y="2" rx="20" ry="20" width="100" height="120" />
  <line x1="15" y1="18" x2="90" y2="18" />
  <line x1="25" y1="36" x2="90" y2="36" />
  <line x1="25" y1="54" x2="90" y2="54" />
  <line x1="15" y1="72" x2="90" y2="72" />
  <line x1="25" y1="89" x2="90" y2="89" />
  <line x1="25" y1="106" x2="90" y2="106" />
</svg>
<svg
   style="display:none;left:18.8%;top:0;position:fixed;z-index:+2"
   width="200"
   height="87.5%"
   viewBox="0 0 10 1"
   version="1.1"
   id="tocBackButton"
   inkscape:version="1.1 (c4e8f9ed74, 2021-05-24)"
   sodipodi:docname="toc-back.svg"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:svg="http://www.w3.org/2000/svg">
  <defs
     id="defs2" />
  <g
     inkscape:label="Layer 1"
     inkscape:groupmode="layer"
     id="layer1">
    <rect
       onclick="sideTOCOff();"
       onmouseover="tocBackColorOn();"
       onmouseout="tocBackColorOff();"
       style="fill:#fff6d5;stroke:#ffcc00;stroke-width:0.257858"
       id="rect99"
       width="1.3457851"
       height="3.967304"
       x="1.4001381"
       y="0.12783527" />
    <path
       onclick="sideTOCOff();"
       onmouseover="tocBackColorOn();"
       onmouseout="tocBackColorOff();"
       style="fill:none;stroke:#ffcc00;stroke-width:0.264583px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
       d="M 2.7459233,0.12783527 1.418214,2.1532691 v 0 l 1.3277093,1.9418705"
       id="path1513" />
    <path
       onclick="sideTOCOff();"
       onmouseover="tocBackColorOn();"
       onmouseout="tocBackColorOff();"
       style="fill:none;stroke:#ffcc00;stroke-width:0.264583px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
       d="M 2.7282563,1.0071049 2.0114379,2.1081016 2.7381797,3.1605769"
       id="path1548" />
  </g>
</svg>

<p><a href="https://pandas.pydata.org/"><img src="https://upload.wikimedia.org/wikipedia/commons/e/ed/Pandas_logo.svg" /></a></p>
<section id="pandas-台北動物園裡的那個嗎" class="level2">
<h2>Pandas ？台北動物園裡的那個嗎？</h2>
<p>不是，至少這裡不是。</p>
<p>Pandas 是 Python 程式語言的資料處理、數據分析開源套件之一。它提供一個類似電子試算表的資料結構，讓使用者可以輕鬆的查閱、運算、調整或作圖（依賴外部套件）。<br />
Pandas 被廣泛的應用在 python 的資料處理、科學運算、統計分析等等領域，說是 Python 資料科學的核心也不為過。<br />
由於近似於電子試算表， Pandas 特別擅長於<a href="Descriptive%20statistics">描述統計學</a> ，與 <a href="https://matplotlib.org/">Matplotlib</a> 通力合作可輕鬆將資料視覺化呈現。另外它對時間及日期格式的支援也相當豐富，因此商業實務上經常會用到的時間序列分析 Pandas 也是得心應手。</p>
<p>更別提它讀取和處理大量資料的速度在 Python 套件中也是數一數二，作為後續機器學習、統計推論等等的資料中繼處理站也相當合適。</p>
</section>
<section id="真正開始之前" class="level2">
<h2>真正開始之前…</h2>
<details>
<summary onmouseover="this.style=&#39;background-color:#deeefc;font-size:1.17em;font-weight: bold;&#39;" onmouseout="this.style=&#39;background-color:none;font-size:1.17em;font-weight: bold;&#39;" style="font-size:1.17em;font-weight: bold;">
書寫慣例
</summary>
<p>本文主旨是帶大家快速看過基本的操作，未來要用到時有個印象「噢！Pandas 好像能做到這個」這樣。</p>
<p>容易混淆的、從字面上比較難懂的、以及自創詞會在該詞中文第一次出現時在後方括號裡附上原文，例如類型（ class ）與類別（ type ）。每當我寫到「類型」時就不會是「類別」，反之亦然。另外 Pandas 與 Python 這種專有名詞我會保留原文。</p>
<p>接下來會大量提到 Pandas 的函式與物件。在本文提到的應用程式接口（ Application Programming Interface, 下稱 API ）都是不完整的，但在第一次介紹時我會附上其官方文件的連結。官方文件裡會對該 API 做完整且詳盡的介紹，有興趣者請隨連結查閱。另外，本文中如果是 <code class="sourceCode python">DataFrame</code> 用到該方法，連結就會把我們帶到 <code class="sourceCode python">DataFrame</code> 的該方法 API 頁面。但是事實上有相當多的方法若 <code class="sourceCode python">DataFrame</code> 有，<code class="sourceCode python">Series</code> 也會有相同功能但專屬於它自己的版本，反之亦然。這部份還請大家多留意。</p>
<p>內文與標題會有一些使用等寬、無裝飾、且帶有底色的英文字串，那些字代表你可以在 Python 程式碼手稿（ script ）或互動式指令介面（ interactive shell ）裡用完全相同的語句參照（ reference ）到該物件、又或是代表程式語言相關的字詞（例如：<code class="sourceCode python"><span class="bu">int</span></code> 類別），或者終端機（ terminal ）指令。另外，內文與標題的模組（ module ）名稱會是全名，跟程式碼區塊中的有所不同。底下安裝與匯入一節有做說明。</p>
<p>Python 程式碼範例的部份，考慮到精簡、易懂與泛用，本文會使用 <a href="https://ipython.org/">IPython</a> 指令介面的書寫格式：</p>
<ul>
<li><code class="sourceCode python">In [N}:</code> 代表人手輸入的第一行，N 是一個數字，代表是這個 IPython 指令介面對談（ session ，或稱工作階段）中的第 N 個指令</li>
<li><code class="sourceCode python">...:</code> 用於表示一行沒有完成的程式碼區塊</li>
<li><code class="sourceCode python">Out[M]:</code> 第 M 個輸入（ <code class="sourceCode python">In [M]:</code> ）的輸出</li>
</ul>
<p>例如：</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">1</span>]: a <span class="op">=</span> {</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>   ...:     <span class="st">&#39;a&#39;</span>: <span class="st">&#39;apple&#39;</span>,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>   ...:     <span class="st">&#39;b&#39;</span>: <span class="st">&#39;banana&#39;</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>   ...:     }</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">2</span>]: a</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">2</span>]: {<span class="st">&#39;a&#39;</span>: <span class="st">&#39;apple&#39;</span>, <span class="st">&#39;b&#39;</span>: <span class="st">&#39;banana&#39;</span>}</span></code></pre></div>
<p>一個 <code class="sourceCode python">In [N]:</code> 後面連接零個到數個 <code class="sourceCode python">...:</code> 標示一個完整的指令。</p>
</details>
<section id="安裝與匯入" class="level3">
<h3>安裝與匯入</h3>
<section id="安裝" class="level4">
<h4>安裝</h4>
<p>最方便、適用新手的安裝方式是直接安裝 <a href="https://www.anaconda.com/">Anaconda</a> ，它把資料科學需要的工具鏈一次性的幫我們裝好 — 包含 NumPy 、 Pandas 、 Matplotlib 、 與 SciPy 等等。</p>
<ul>
<li><p>經由 <a href="https://pypi.org/">PyPI</a> 安裝</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install pandas</span></code></pre></div></li>
<li><p>經由 Conda 安裝 — 若你安裝的是 Miniconda 的話</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> install pandas</span></code></pre></div></li>
</ul>
<p>其他的安裝方式請洽官方網站的<a href="https://pandas.pydata.org/docs/getting_started/install.html">安裝指引</a> 。</p>
</section>
<section id="匯入" class="level4">
<h4>匯入</h4>
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">1</span>]: <span class="im">import</span> pandas <span class="im">as</span> pd</span></code></pre></div>
<p>將 Pandas 匯入成「 pd 」是資料科學界的習慣，接下來的程式碼區塊中我將會預設 Pandas 已被匯入成 <code class="sourceCode python">pd</code> 。</p>
</section>
</section>
</section>
<section id="適用於-pandas-的資料長怎樣" class="level2">
<h2>適用於 Pandas 的資料長怎樣？</h2>
<p>如果你曾經用過微軟的 Excel 、Apple 的 Numbers ，Pandas 處理資料的方式就長差不多那樣 — 一張二維的巨大表單。這張表單的每一行、每一列都有其獨一無二的名稱，行與列的名稱並不算資料內容，僅用來定位資料。</p>
<p>這張資料表在 Pandas 裡面稱為 <a href="https://pandas.pydata.org/docs/reference/frame.html"><code class="sourceCode python">DataFrame</code></a> ，而每一欄位的資料內容（整行）單獨抽取出來叫做 <a href="https://pandas.pydata.org/docs/reference/series.html"><code class="sourceCode python">Series</code></a> 。</p>
<svg width="100%" height="476" viewBox="0 0 297.65516 125.94208" version="1.1" id="svg5" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg">
<defs
     id="defs2" /> <g
     id="layer1"> <path
       id="use1370"
       style="opacity:0.514214;fill:#0f2d65;fill-opacity:0.282933;stroke-width:0.264583"
       d="m 128.08121,111.33721 h 39.63419 v 12.77956 h -39.63419 z m 0,-14.420502 h 39.63419 v 12.779562 h -39.63419 z m 0,-14.420509 h 39.63419 v 12.779557 h -39.63419 z m 0,-14.420502 h 39.63419 v 12.779557 h -39.63419 z m 0,-14.420502 H 167.7154 V 66.434753 H 128.08121 Z M 86.806077,111.33721 h 39.634183 v 12.77956 H 86.806077 Z m 0,-14.420502 H 126.44026 V 109.69627 H 86.806077 Z m 0,-14.420509 H 126.44026 V 95.275756 H 86.806077 Z m 0,-14.420502 H 126.44026 V 80.855254 H 86.806077 Z m 0,-14.420502 H 126.44026 V 66.434753 H 86.806077 Z M 45.530941,111.33721 h 39.634186 v 12.77956 H 45.530941 Z m 0,-14.420502 H 85.165127 V 109.69627 H 45.530941 Z m 0,-14.420509 H 85.165127 V 95.275756 H 45.530941 Z m 0,-14.420502 H 85.165127 V 80.855254 H 45.530941 Z m 0,-14.420502 H 85.165127 V 66.434753 H 45.530941 Z" /> <path
       id="use23282"
       style="fill:#81b4fe;fill-opacity:0.642038;stroke-width:0.276636"
       d="m 128.00927,36.200411 h 39.52747 v 12.779553 h -39.52747 z m -41.164003,0 H 126.37274 V 48.979964 H 86.845267 Z m -41.164009,0 H 85.208737 V 48.979964 H 45.681258 Z" /> <path
       id="use24758"
       style="fill:#81b4fe;fill-opacity:0.642038;stroke-width:0.277009"
       d="m 1.316482,111.77439 h 39.634189 v 12.77956 H 1.316482 Z m 0,-14.420497 H 40.950671 V 110.13345 H 1.316482 Z m 0,-14.420498 H 40.950671 V 95.712948 H 1.316482 Z m 0,-14.420499 H 40.950671 V 81.292449 H 1.316482 Z m 0,-14.420499 H 40.950671 V 66.87195 H 1.316482 Z" /> <path
       id="use24758-0"
       style="fill:#81b4fe;fill-opacity:0.642038;stroke-width:0.277009"
       d="m 212.49546,111.739 h 39.63419 v 12.77956 h -39.63419 z m 0,-14.420493 h 39.63419 v 12.779553 h -39.63419 z m 0,-14.420498 h 39.63419 v 12.779553 h -39.63419 z m 0,-14.420499 h 39.63419 v 12.779553 h -39.63419 z m 0,-14.420499 h 39.63419 v 12.779553 h -39.63419 z" /> <path
       id="path24948-2"
       style="opacity:0.514214;fill:#0f2d65;fill-opacity:0.282353;stroke:none;stroke-width:0.264583"
       d="m 256.76788,111.73901 h 39.63419 v 12.77956 h -39.63419 z m 0,-14.420491 h 39.63419 v 12.779551 h -39.63419 z m 0,-14.420509 h 39.63419 v 12.779557 h -39.63419 z m 0,-14.420502 h 39.63419 v 12.779557 h -39.63419 z m 0,-14.420502 h 39.63419 v 12.779558 h -39.63419 z" /> <text
       xml:space="preserve"
       style="font-style:normal;font-weight:normal;font-size:20.9221px;line-height:1.25;font-family:sans-serif;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.523052"
       x="28.221357"
       y="24.273218"
       id="text33110"><tspan
         id="tspan33108"
         style="stroke-width:0.523052"
         x="28.221357"
         y="24.273218">Dataframe</tspan></text> <text
       xml:space="preserve"
       style="font-style:normal;font-weight:normal;font-size:19.9724px;line-height:1.25;font-family:sans-serif;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.499309"
       x="224.69026"
       y="42.631416"
       id="text39262"><tspan
         id="tspan39260"
         style="stroke-width:0.499309"
         x="224.69026"
         y="42.631416">Series</tspan></text> </g>
</svg>
<p>我們可以用字典（ <code class="sourceCode python"><span class="bu">dict</span></code> ）來製作 <code class="sourceCode python">DataFrame</code> 。字典的鍵是 <code class="sourceCode python">DataFrame</code> 欄（ column ）的名稱，該鍵的值（ value ）即為該欄位的資料，<code class="sourceCode python">index</code> 這個位置參數則指定每一列（ row ）的名稱。</p>
<p>例如，這是我對我家附近幾間餐廳的評價：</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">2</span>]: df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>   ...:     <span class="st">&#39;步行時間（分鐘）&#39;</span>: [<span class="dv">100</span>, <span class="dv">20</span>, <span class="dv">10</span>, <span class="dv">5</span>],</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>   ...:     <span class="st">&#39;最好吃&#39;</span>: [<span class="st">&#39;服務生的衣服香味&#39;</span>, <span class="st">&#39;咖茲咖茲好吃到噗啾甜甜圈&#39;</span>, <span class="st">&#39;草莓聖代&#39;</span>, <span class="st">&#39;可樂（大杯）&#39;</span>],</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>   ...:     <span class="st">&#39;整體評分&#39;</span>: [<span class="fl">100.0</span>, <span class="fl">8.5</span>, <span class="fl">7.0</span>, <span class="fl">3.5</span>],</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>   ...:     <span class="st">&#39;最後評價日期&#39;</span>: [<span class="st">&#39;2021-02-21&#39;</span>, <span class="st">&#39;2021-01-15&#39;</span>, <span class="st">&#39;2021-03-04&#39;</span>, <span class="st">&#39;2021-02-10&#39;</span>]</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>   ...:     },</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>   ...:     index<span class="op">=</span>[<span class="st">&#39;彈簧貓 Cofe&#39;</span>, <span class="st">&#39;Mr. Hole&#39;</span>, <span class="st">&#39;-273 C&#39;</span>, <span class="st">&#39;藍藍路&#39;</span>])</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">3</span>]: df</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">3</span>]:</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>              步行時間（分鐘）                  最好吃    整體評分      最後評價日期</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>彈簧貓 Cofe             <span class="dv">100</span>           服務生的衣服香味      <span class="fl">100.0</span>     <span class="dv">2021</span><span class="op">-</span><span class="dv">02</span><span class="op">-</span><span class="dv">21</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>Mr. Hole                <span class="dv">20</span>    咖茲咖茲好吃到噗啾甜甜圈        <span class="fl">8.5</span>     <span class="dv">2021</span><span class="op">-</span><span class="dv">01</span><span class="op">-</span><span class="dv">15</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="op">-</span><span class="dv">273</span> C                  <span class="dv">10</span>                  草莓聖代       <span class="fl">7.0</span>     <span class="dv">2021</span><span class="op">-</span><span class="dv">03</span><span class="op">-</span><span class="dv">04</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>藍藍路                    <span class="dv">5</span>               可樂（大杯）       <span class="fl">3.5</span>     <span class="dv">2021</span><span class="op">-</span><span class="dv">02</span><span class="op">-</span><span class="dv">10</span></span></code></pre></div>
<p>就差不多是這個意思：</p>
<p><img src="./media/spreadsheet-example.png" /></p>
<p>將其中一欄取出，我們會得到 <code class="sourceCode python">Series</code> ：</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">4</span>]: df[<span class="st">&#39;整體評分&#39;</span>]</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">4</span>]:</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>彈簧貓 Cof<span class="st">&#39;e    100.0</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="st">Mr. Hole         8.5</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="st">-273 C           7.0</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="st">藍藍路            3.5</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="st">Name: 整體評分, dtype: float64</span></span></code></pre></div>
<p>如果你熟悉 Python 的字典，這個語法是完全一樣的。<br />
（由於欄位名稱是資料表的屬性之一，我們也可以利用 <code class="sourceCode python">df.整體評分</code> 來做到同樣的事。）</p>
<p>當然，你可以使用串列主動製作一個 <code class="sourceCode python">Series</code> ：</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">5</span>]: pd.Series([<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>], name<span class="op">=</span><span class="st">&#39;五的倍數&#39;</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">5</span>]:</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>     <span class="dv">5</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>    <span class="dv">10</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>    <span class="dv">15</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>    <span class="dv">20</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>Name: 五的倍數, dtype: int64</span></code></pre></div>
<p>然後再把 <code class="sourceCode python">Series</code> 插入或將許多 <code class="sourceCode python">Series</code> 組合成一個 <code class="sourceCode python">DataFrame</code> 。</p>
<p>要注意的是，如果把 <code class="sourceCode python">index</code> 這個參數省略，預設列的名稱（也就是資料列的索引）會是 0, 1, 2, 3, … 的數字。</p>
</section>
<section id="我能從檔案讀取資料嗎" class="level2">
<h2>我能從檔案讀取資料嗎？</h2>
<p>「打字好沒效率喔！我想要直接把資料從檔案讀入。」</p>
<p>Pandas 提供不少種檔案類型可以直接輸入，也提供不少種檔案類型可以輸出。常見的類型包含： csv 、 JSON 、 Excel ，甚至透過 API 直接跟關聯式資料庫請求資料。</p>
<p>本例使用的資料集是政府資料開放平台的「<a href="https://data.gov.tw/dataset/120711">地區年齡性別統計表-嚴重特殊傳染性肺炎-依個案研判日統計</a>」資料集，於西元 2021 年 7 月 23 日晚間 11:53 取得。</p>
<details>
<summary onmouseover="this.style=&#39;background-color:#deeefc;&#39;" onmouseout="this.style=&#39;background-color:none;&#39;">
欄位解釋
</summary>
<ul>
<li>確定病名：經診斷確認之疾病名稱</li>
<li>個案研判日：西元年/月/日</li>
<li>縣市：確診個案所在縣市</li>
<li>鄉鎮：確診個案所在鄉鎮</li>
<li>性別：確診個案性別</li>
<li>是否為境外移入：個案是否為境外移入</li>
<li>年齡層：個案年齡區間，一區間為 5 年</li>
<li>確定病例數：個案確診的病患數目</li>
</ul>
</details>
<section id="從逗號分隔值-csv-檔案讀取資料" class="level4">
<h4>從逗號分隔值（ csv ）檔案讀取資料</h4>
<p>我們可以利用 <code class="sourceCode python">pandas.read_csv</code> 函式將資料從逗號分隔值檔案中讀入：</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">6</span>]: covid <span class="op">=</span> pd.read_csv(<span class="st">&#39;data/Day_Confirmation_Age_County_Gender_19CoV.csv&#39;</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">7</span>]: covid</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">7</span>]:</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>            確定病名       個案研判日    縣市    鄉鎮 性別 是否為境外移入    年齡層  確定病例數</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>      嚴重特殊傳染性肺炎  <span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">22</span>    空值    空值  女       是            <span class="dv">55</span><span class="op">-</span><span class="dv">59</span>      <span class="dv">1</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>      嚴重特殊傳染性肺炎  <span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">24</span>    空值    空值  女       是            <span class="dv">50</span><span class="op">-</span><span class="dv">54</span>      <span class="dv">1</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>      嚴重特殊傳染性肺炎  <span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">24</span>    空值    空值  男       是            <span class="dv">55</span><span class="op">-</span><span class="dv">59</span>      <span class="dv">1</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>      嚴重特殊傳染性肺炎  <span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">26</span>    空值    空值  女       是            <span class="dv">55</span><span class="op">-</span><span class="dv">59</span>      <span class="dv">1</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>      嚴重特殊傳染性肺炎  <span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">27</span>    空值    空值  女       是            <span class="dv">50</span><span class="op">-</span><span class="dv">54</span>      <span class="dv">1</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>...          ...         ...  ...  ... ..     ...    ...    ...</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="dv">10999</span>  嚴重特殊傳染性肺炎  <span class="dv">2021</span><span class="op">/</span><span class="dv">07</span><span class="op">/</span><span class="dv">22</span>   新北市  板橋區  男       否            <span class="dv">25</span><span class="op">-</span><span class="dv">29</span>      <span class="dv">1</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="dv">11000</span>  嚴重特殊傳染性肺炎  <span class="dv">2021</span><span class="op">/</span><span class="dv">07</span><span class="op">/</span><span class="dv">22</span>   新北市  板橋區  男       否            <span class="dv">30</span><span class="op">-</span><span class="dv">34</span>      <span class="dv">1</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="dv">11001</span>  嚴重特殊傳染性肺炎  <span class="dv">2021</span><span class="op">/</span><span class="dv">07</span><span class="op">/</span><span class="dv">22</span>   新北市  泰山區  男       否            <span class="dv">45</span><span class="op">-</span><span class="dv">49</span>      <span class="dv">1</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="dv">11002</span>  嚴重特殊傳染性肺炎  <span class="dv">2021</span><span class="op">/</span><span class="dv">07</span><span class="op">/</span><span class="dv">22</span>   新北市  淡水區  男       否            <span class="dv">35</span><span class="op">-</span><span class="dv">39</span>      <span class="dv">1</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="dv">11003</span>  嚴重特殊傳染性肺炎  <span class="dv">2021</span><span class="op">/</span><span class="dv">07</span><span class="op">/</span><span class="dv">22</span>   新北市  樹林區  女       否            <span class="dv">35</span><span class="op">-</span><span class="dv">39</span>      <span class="dv">1</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>[<span class="dv">11004</span> rows x <span class="dv">8</span> columns]</span></code></pre></div>
</section>
<section id="同事說他只看-excel-檔其他不接受" class="level4">
<h4>同事說他只看 Excel 檔，其他不接受</h4>
<p><a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.to_excel.html"><code class="sourceCode python">pandas.to_excel</code></a> 這個函式可以將 <code class="sourceCode python">DataFrame</code> 匯出成 Excel 的專屬檔案。</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">8</span>]: covid.to_excel(<span class="st">&#39;covid.xlsx&#39;</span>, sheet_name<span class="op">=</span><span class="st">&#39;Covid&#39;</span>, index<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
<p><code class="sourceCode python">sheet_name</code> 這個參數用來更改分頁的名稱、<code class="sourceCode python">index</code> 可為 <code class="sourceCode python"><span class="va">True</span></code> 或 <code class="sourceCode python"><span class="va">False</span></code> ，若 <code class="sourceCode python"><span class="va">True</span></code> 則會把資料列的索引值填入第一行。</p>
<p>註： 匯出成 Excel 檔需要用到 <code class="sourceCode python">openpyxl</code> 這個套件的協助。</p>
</section>
<section id="pandas-的-read_-與-to_-函式" class="level4">
<h4>Pandas 的 <code class="sourceCode python">read_<span class="op">*</span></code> 與 <code class="sourceCode python">to_<span class="op">*</span></code> 函式</h4>
<p>Pandas 很貼心的把所有讀入的函式都寫成 <code class="sourceCode python">pandas.read_<span class="op">*</span></code> 、所有匯出的函式都寫成 <code class="pyhton">pandas.to_*</code> 。<br />
這兩個方法的 * 符號可以帶入有支援的各種檔案類型或目標。</p>
<p>舉例來說，若要把剛剛右鍵複製下來的資料讀入，使用 <a href="https://pandas.pydata.org/docs/reference/api/pandas.read_clipboard.html"><code class="sourceCode python">pandas.read_clipboard</code></a> ；想把資料匯出成 json 檔則使用 <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.to_json.html?"><code class="sourceCode python">pandas.to_json</code></a> 。</p>
<p>至於到底支援哪些檔案或來源以及如何使用，官方的<a href="https://pandas.pydata.org/docs/user_guide/io.html">輸出入工具列表</a>有做詳盡的介紹。</p>
</section>
</section>
<section id="我要怎麼觀察我的資料" class="level2">
<h2>我要怎麼觀察我的資料？</h2>
<section id="初步觀察與元資料-metadata" class="level3">
<h3>初步觀察與元資料（ metadata ）</h3>
<p>資料入後我們總是會想看看有沒有出問題，我們可以選擇直接印出。<code class="sourceCode python">DataFrame</code> 被直接印出時，若 Pandas 判斷資料列過多，會像上面的例子一樣 — 頭尾各取 5 列、中間用 … 表示有跳行。</p>
<section id="單純想查看資料的頭尾" class="level4">
<h4>單純想查看資料的頭、尾</h4>
<p>如果我們想看看資料的最上面或最下面，可以利用 <code class="sourceCode python">DataFrame</code> 的 <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.head.html"><code class="sourceCode python">head</code></a> 和 <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.tail.html"><code class="sourceCode python">tail</code></a> 方法達成。<br />
<code class="sourceCode python">head</code> 與 <code class="sourceCode python">tail</code> 可以接受一個整數作為參數，標示你要看幾行（預設是一次看 5 行）。</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">9</span>]: covid.head(<span class="dv">8</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">9</span>]:</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>        確定病名       個案研判日   縣市    鄉鎮  性別 是否為境外移入    年齡層  確定病例數</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>  嚴重特殊傳染性肺炎  <span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">22</span>   空值    空值   女       是            <span class="dv">55</span><span class="op">-</span><span class="dv">59</span>      <span class="dv">1</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>  嚴重特殊傳染性肺炎  <span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">24</span>   空值    空值   女       是            <span class="dv">50</span><span class="op">-</span><span class="dv">54</span>      <span class="dv">1</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>  嚴重特殊傳染性肺炎  <span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">24</span>   空值    空值   男       是            <span class="dv">55</span><span class="op">-</span><span class="dv">59</span>      <span class="dv">1</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>  嚴重特殊傳染性肺炎  <span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">26</span>   空值    空值   女       是            <span class="dv">55</span><span class="op">-</span><span class="dv">59</span>      <span class="dv">1</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>  嚴重特殊傳染性肺炎  <span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">27</span>   空值    空值   女       是            <span class="dv">50</span><span class="op">-</span><span class="dv">54</span>      <span class="dv">1</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>  嚴重特殊傳染性肺炎  <span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">28</span>   空值    空值   女       是              <span class="dv">70</span><span class="op">+</span>      <span class="dv">2</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>  嚴重特殊傳染性肺炎  <span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">28</span>  彰化縣  和美鎮   男       否            <span class="dv">50</span><span class="op">-</span><span class="dv">54</span>      <span class="dv">1</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span>  嚴重特殊傳染性肺炎  <span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">30</span>  南投縣  南投市   女       否            <span class="dv">40</span><span class="op">-</span><span class="dv">44</span>      <span class="dv">1</span></span></code></pre></div>
</section>
<section id="想查看關於這份資料的資料元資料" class="level4">
<h4>想查看關於這份資料的資料（元資料）</h4>
<p>我們可以用 <code class="sourceCode python">shape</code> 這個屬性來知道這份資料表有多大：</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">10</span>]: covid.shape</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">10</span>]: (<span class="dv">11004</span>, <span class="dv">8</span>)</span></code></pre></div>
<p>看起來我們有 1,1004 筆資料，每筆資料包含 8 個資料欄位。</p>
<p><a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.describe.html"><code class="sourceCode python">describe</code></a> 方法可以自動幫我們做一些簡單的統計：</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">11</span>]: covid.describe()</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">11</span>]:</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>          確定病例數</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>count  <span class="fl">11004.000000</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>mean       <span class="fl">1.411759</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>std        <span class="fl">1.191373</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="bu">min</span>        <span class="fl">1.000000</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="dv">25</span><span class="op">%</span>        <span class="fl">1.000000</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="dv">50</span><span class="op">%</span>        <span class="fl">1.000000</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="dv">75</span><span class="op">%</span>        <span class="fl">1.000000</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="bu">max</span>       <span class="fl">23.000000</span></span></code></pre></div>
<p>預設的情況下，只有數字型態（ numeric ）的資料欄會被列入計算。我們只有「確定病例數」是數字型態的資料欄位，自然也只有這一欄的結果。</p>
<details>
<summary onmouseover="this.style=&#39;background-color:#deeefc;&#39;" onmouseout="this.style=&#39;background-color:none;&#39;">
輸出文字的意義
</summary>
<ul>
<li>count ：非空值的資料筆數</li>
<li>mean ：平均值</li>
<li>std ：標準差</li>
<li>min ：最小值</li>
<li>25% ：從最小排到最大時，位於 <span class="math inline">\(\frac{1}{4}\)</span> 位置的值</li>
<li>50% ：從最小排到最大時，位於 <span class="math inline">\(\frac{1}{2}\)</span> 位置的值</li>
<li>75% ：從最小排到最大時，位於 <span class="math inline">\(\frac{3}{4}\)</span> 位置的值</li>
<li>max ：最大值</li>
</ul>
</details>
<p><a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.info.html"><code class="sourceCode python">info</code></a> 方法則會給我們技術方面的資訊：</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">12</span>]: covid.info()</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span><span class="kw">class</span> <span class="st">&#39;pandas.core.frame.DataFrame&#39;</span><span class="op">&gt;</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>RangeIndex: <span class="dv">11004</span> entries, <span class="dv">0</span> to <span class="dv">11003</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>Data columns (total <span class="dv">8</span> columns):</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a> <span class="co">#   Column          Non-Null Count  Dtype</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="op">---</span>  <span class="op">------</span>          <span class="op">--------------</span>  <span class="op">-----</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a> <span class="dv">0</span>   確定病名        <span class="dv">11004</span> non<span class="op">-</span>null  <span class="bu">object</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span>   個案研判日       <span class="dv">11004</span> non<span class="op">-</span>null  <span class="bu">object</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span>   縣市           <span class="dv">11004</span> non<span class="op">-</span>null  <span class="bu">object</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span>   鄉鎮           <span class="dv">11004</span> non<span class="op">-</span>null  <span class="bu">object</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span>   性別           <span class="dv">11004</span> non<span class="op">-</span>null  <span class="bu">object</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span>   是否為境外移入   <span class="dv">11004</span> non<span class="op">-</span>null  <span class="bu">object</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span>   年齡層          <span class="dv">11004</span> non<span class="op">-</span>null  <span class="bu">object</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span>   確定病例數      <span class="dv">11004</span> non<span class="op">-</span>null  int64</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>dtypes: int64(<span class="dv">1</span>), <span class="bu">object</span>(<span class="dv">7</span>)</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>memory usage: <span class="fl">687.9</span><span class="op">+</span> KB</span></code></pre></div>
<p>我們可以看到各欄位的資料類型 — 前七欄為 <code class="sourceCode python"><span class="bu">object</span></code> 、最後一欄為 <code class="sourceCode python">int64</code> （ 64 位元整數）。<br />
前七欄是 <code class="sourceCode python"><span class="bu">object</span></code> 的原因是因為它們都是 Python 的字串（ <code class="sourceCode python"><span class="bu">str</span></code> ）。</p>
<details>
<summary onmouseover="this.style=&#39;background-color:#deeefc;&#39;" onmouseout="this.style=&#39;background-color:none;&#39;">
其他資訊包含
</summary>
<ul>
<li>資料類型 ：這裡顯示 <code class="sourceCode python">covid</code> 的確是個 <code class="sourceCode python">DataFrame</code></li>
<li>RangeIndex ：索引的數量及可用的索引值，當成資料列數列就對了</li>
<li>dtypes ：欄位資料類型的統計</li>
<li>memory usage ：這份資料佔了多少記憶體</li>
</ul>
</details>
<p>值得注意的是，若 memory usage 出現 + 號（就像這個例子），代表實際佔用的記憶體比顯示的還多。想確知真正佔用的記憶體大小，請把 <code class="sourceCode python">memory_usage<span class="op">=</span><span class="st">&#39;deep&#39;</span></code> 作為參數呼叫 <code class="sourceCode python">info</code> 。</p>
</section>
</section>
<section id="我只想看中間一部分而已" class="level3">
<h3>我只想看中間一部分而已</h3>
<section id="選取指定數個欄位" class="level4">
<h4>選取指定數個欄位</h4>
<p>除了類似字典取值，選取單個欄位的語法外， <code class="sourceCode python">DataFrame</code> 也提供一次選取多個欄位的語法。<br />
比如說，我們對「個案研判日」以及「確定病例數」有興趣：</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">13</span>]: covid[[<span class="st">&#39;個案研判日&#39;</span>, <span class="st">&#39;確定病例數&#39;</span>]].head()</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">13</span>]:</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>        個案研判日    確定病例數</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>       <span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">22</span>      <span class="dv">1</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>       <span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">24</span>      <span class="dv">1</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>       <span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">24</span>      <span class="dv">1</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>       <span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">26</span>      <span class="dv">1</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>       <span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">27</span>      <span class="dv">1</span></span></code></pre></div>
<p>語法是 <code class="sourceCode python">DataFrame</code> 後面接上一個中括號（如同原生 Python 的切片語法），中括號內放入包含欄位名稱的串列。</p>
<p>經過觀察後，我們會發現第一欄「確定病名」全部都是「嚴重特殊傳染性肺炎」，這欄基本上沒有存在的意義。<br />
我們不要看它：</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">14</span>]: new_cols <span class="op">=</span> covid.columns.drop(<span class="st">&#39;確定病名&#39;</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">15</span>]: new_cols</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">15</span>]: Index([<span class="st">&#39;個案研判日&#39;</span>, <span class="st">&#39;縣市&#39;</span>, <span class="st">&#39;鄉鎮&#39;</span>, <span class="st">&#39;性別&#39;</span>, <span class="st">&#39;是否為境外移入&#39;</span>, <span class="st">&#39;年齡層&#39;</span>, <span class="st">&#39;確定病例數&#39;</span>], dtype<span class="op">=</span><span class="st">&#39;object&#39;</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">16</span>]: covid[new_cols].head()</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">16</span>]:</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>         個案研判日   縣市  鄉鎮 性別 是否為境外移入    年齡層  確定病例數</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>       <span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">22</span>  空值  空值  女       是         <span class="dv">55</span><span class="op">-</span><span class="dv">59</span>      <span class="dv">1</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>       <span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">24</span>  空值  空值  女       是         <span class="dv">50</span><span class="op">-</span><span class="dv">54</span>      <span class="dv">1</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>       <span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">24</span>  空值  空值  男       是         <span class="dv">55</span><span class="op">-</span><span class="dv">59</span>      <span class="dv">1</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>       <span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">26</span>  空值  空值  女       是         <span class="dv">55</span><span class="op">-</span><span class="dv">59</span>      <span class="dv">1</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>       <span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">27</span>  空值  空值  女       是         <span class="dv">50</span><span class="op">-</span><span class="dv">54</span>      <span class="dv">1</span></span></code></pre></div>
<p>這裡我們利用 <code class="sourceCode python">DataFrame.columns</code> 這個屬性。這個屬性會回傳一個 <a href="https://pandas.pydata.org/docs/reference/api/pandas.Index.html"><code class="sourceCode python">pandas.Index</code></a> 物件，裡面是所有的欄位名稱。<br />
再來我們利用 <code class="sourceCode python">Index</code> 物件的 <a href="https://pandas.pydata.org/docs/reference/api/pandas.Index.drop.html"><code class="sourceCode python">drop</code></a> 方法把「確定病名」刪除。刪除後就可以利用新的欄位選取列表來選擇我們想要的資料欄。</p>
</section>
<section id="選取一定範圍的資料列" class="level4">
<h4>選取一定範圍的資料列</h4>
<p>我們可以在 <code class="sourceCode python">DataFrame</code> 後面接中括弧，中括弧裡使用「索引:另一個索引」這樣的語法來取得特定範圍內的資料列。</p>
<p>還記得我的餐廳評價表嗎？如果我們吃膩藍藍路，現在完全不想考慮它，我們可以這樣選：</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">17</span>]: df[<span class="st">&#39;彈簧貓 Cofe&#39;</span>:<span class="st">&#39;-273 C&#39;</span>]</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">17</span>]:</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>             步行時間（分鐘）           最好吃         整體評分      最後評價日期</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>彈簧貓 Cofe       <span class="dv">100</span>             服務生的衣服香味      <span class="fl">100.0</span>         <span class="dv">2021</span><span class="op">-</span><span class="dv">02</span><span class="op">-</span><span class="dv">21</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>Mr. Hole          <span class="dv">20</span>         咖茲咖茲好吃到噗啾甜甜圈     <span class="fl">8.5</span>         <span class="dv">2021</span><span class="op">-</span><span class="dv">01</span><span class="op">-</span><span class="dv">15</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="op">-</span><span class="dv">273</span> C            <span class="dv">10</span>                 草莓聖代           <span class="fl">7.0</span>         <span class="dv">2021</span><span class="op">-</span><span class="dv">03</span><span class="op">-</span><span class="dv">04</span></span></code></pre></div>
<p>又或是我們對特定範圍的 Covid-19 有興趣：</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">18</span>]: covid[<span class="dv">500</span>:<span class="dv">503</span>]</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">18</span>]:</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>          確定病名       個案研判日  縣市  鄉鎮 性別 是否為境外移入      年齡層   確定病例數</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="dv">500</span>  嚴重特殊傳染性肺炎  <span class="dv">2020</span><span class="op">/</span><span class="dv">11</span><span class="op">/</span><span class="dv">28</span>  空值  空值  女       是            <span class="dv">45</span><span class="op">-</span><span class="dv">49</span>      <span class="dv">1</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="dv">501</span>  嚴重特殊傳染性肺炎  <span class="dv">2020</span><span class="op">/</span><span class="dv">11</span><span class="op">/</span><span class="dv">28</span>  空值  空值  男       是            <span class="dv">20</span><span class="op">-</span><span class="dv">24</span>      <span class="dv">1</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="dv">502</span>  嚴重特殊傳染性肺炎  <span class="dv">2020</span><span class="op">/</span><span class="dv">11</span><span class="op">/</span><span class="dv">29</span>  空值  空值  女       是            <span class="dv">20</span><span class="op">-</span><span class="dv">24</span>      <span class="dv">1</span></span></code></pre></div>
<p>注意到了嗎？由於剛才我們建立 covid 這個資料表的時候沒有指定 <code class="sourceCode python">index</code> 參數，所以 Pandas 主動幫每個資料列補上一個整數作為索引。</p>
</section>
<section id="選取一定範圍資料列中的指定欄位" class="level4">
<h4>選取一定範圍資料列中的指定欄位</h4>
<p>假設我們對第 1000 到第 1010 筆資料的性別、年齡層與確定病例數有興趣：</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">19</span>]: covid[<span class="dv">1000</span>:<span class="dv">1011</span>][[<span class="st">&#39;性別&#39;</span>, <span class="st">&#39;年齡層&#39;</span>, <span class="st">&#39;確定病例數&#39;</span>]]</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">19</span>]:</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>     性別    年齡層  確定病例數</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="dv">1000</span>  女      <span class="dv">40</span><span class="op">-</span><span class="dv">44</span>      <span class="dv">1</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="dv">1001</span>  女      <span class="dv">55</span><span class="op">-</span><span class="dv">59</span>      <span class="dv">1</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="dv">1002</span>  女      <span class="dv">25</span><span class="op">-</span><span class="dv">29</span>      <span class="dv">1</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="dv">1003</span>  女      <span class="dv">35</span><span class="op">-</span><span class="dv">39</span>      <span class="dv">1</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="dv">1004</span>  男      <span class="dv">20</span><span class="op">-</span><span class="dv">24</span>      <span class="dv">2</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="dv">1005</span>  男      <span class="dv">25</span><span class="op">-</span><span class="dv">29</span>      <span class="dv">6</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="dv">1006</span>  男      <span class="dv">30</span><span class="op">-</span><span class="dv">34</span>      <span class="dv">1</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="dv">1007</span>  男      <span class="dv">40</span><span class="op">-</span><span class="dv">44</span>      <span class="dv">1</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="dv">1008</span>  女        <span class="dv">70</span><span class="op">+</span>      <span class="dv">1</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="dv">1009</span>  女      <span class="dv">40</span><span class="op">-</span><span class="dv">44</span>      <span class="dv">1</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="dv">1010</span>  男      <span class="dv">35</span><span class="op">-</span><span class="dv">39</span>      <span class="dv">1</span></span></code></pre></div>
<p>原理是先用 <code class="sourceCode python">covid[<span class="dv">1000</span>:<span class="dv">1011</span>]</code> 將第 1000 到 1010 筆資料列提取出來，再選取想要的欄位。</p>
</section>
<section id="位置索引-dataframe.ilociloc" class="level4">
<h4>位置索引： <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.iloc.html"><code class="sourceCode python">DataFrame.iloc</code></a></h4>
<p><code class="sourceCode python">DataFrame</code> 的 <code class="sourceCode python">iloc</code> 屬性提供一個用數字索引資料的方法，索引的數字代表資料欄或列所在的位置：</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">20</span>]: df.iloc[:<span class="dv">3</span>, <span class="dv">2</span>:]</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">20</span>]:</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>             整體評分      最後評價日期</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>彈簧貓 Cofe   <span class="fl">100.0</span>         <span class="dv">2021</span><span class="op">-</span><span class="dv">02</span><span class="op">-</span><span class="dv">21</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>Mr. Hole       <span class="fl">8.5</span>         <span class="dv">2021</span><span class="op">-</span><span class="dv">01</span><span class="op">-</span><span class="dv">15</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="op">-</span><span class="dv">273</span> C         <span class="fl">7.0</span>         <span class="dv">2021</span><span class="op">-</span><span class="dv">03</span><span class="op">-</span><span class="dv">04</span></span></code></pre></div>
<p>索引前三列的第三欄之後。</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">21</span>]: covid.iloc[<span class="dv">1000</span>:<span class="dv">1011</span>, [<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">7</span>]]</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">21</span>]:</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>           個案研判日   性別     年齡層  確定病例數</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="dv">1000</span>       <span class="dv">2021</span><span class="op">/</span><span class="dv">05</span><span class="op">/</span><span class="dv">13</span>  女      <span class="dv">40</span><span class="op">-</span><span class="dv">44</span>      <span class="dv">1</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="dv">1001</span>       <span class="dv">2021</span><span class="op">/</span><span class="dv">05</span><span class="op">/</span><span class="dv">13</span>  女      <span class="dv">55</span><span class="op">-</span><span class="dv">59</span>      <span class="dv">1</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="dv">1002</span>       <span class="dv">2021</span><span class="op">/</span><span class="dv">05</span><span class="op">/</span><span class="dv">13</span>  女      <span class="dv">25</span><span class="op">-</span><span class="dv">29</span>      <span class="dv">1</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="dv">1003</span>       <span class="dv">2021</span><span class="op">/</span><span class="dv">05</span><span class="op">/</span><span class="dv">13</span>  女      <span class="dv">35</span><span class="op">-</span><span class="dv">39</span>      <span class="dv">1</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="dv">1004</span>       <span class="dv">2021</span><span class="op">/</span><span class="dv">05</span><span class="op">/</span><span class="dv">13</span>  男      <span class="dv">20</span><span class="op">-</span><span class="dv">24</span>      <span class="dv">2</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="dv">1005</span>       <span class="dv">2021</span><span class="op">/</span><span class="dv">05</span><span class="op">/</span><span class="dv">13</span>  男      <span class="dv">25</span><span class="op">-</span><span class="dv">29</span>      <span class="dv">6</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="dv">1006</span>       <span class="dv">2021</span><span class="op">/</span><span class="dv">05</span><span class="op">/</span><span class="dv">13</span>  男      <span class="dv">30</span><span class="op">-</span><span class="dv">34</span>      <span class="dv">1</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="dv">1007</span>       <span class="dv">2021</span><span class="op">/</span><span class="dv">05</span><span class="op">/</span><span class="dv">13</span>  男      <span class="dv">40</span><span class="op">-</span><span class="dv">44</span>      <span class="dv">1</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="dv">1008</span>       <span class="dv">2021</span><span class="op">/</span><span class="dv">05</span><span class="op">/</span><span class="dv">13</span>  女        <span class="dv">70</span><span class="op">+</span>      <span class="dv">1</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="dv">1009</span>       <span class="dv">2021</span><span class="op">/</span><span class="dv">05</span><span class="op">/</span><span class="dv">13</span>  女      <span class="dv">40</span><span class="op">-</span><span class="dv">44</span>      <span class="dv">1</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="dv">1010</span>       <span class="dv">2021</span><span class="op">/</span><span class="dv">05</span><span class="op">/</span><span class="dv">13</span>  男      <span class="dv">35</span><span class="op">-</span><span class="dv">39</span>      <span class="dv">1</span></span></code></pre></div>
<p>索引第 1000 到第 1010 列的第二、五、七、八欄。</p>
<p>注意 <code class="sourceCode python">iloc</code> 屬性索引用的是<strong>中括弧</strong>。</p>
<p><code class="pyhon">iloc</code> 屬性的索引可以分為兩個維度。若是兩個維度的索引則使用一個逗號「 , 」將第一維度（資料列）與第二維度（資料欄）分開。<br />
若是只有給予一個維度，會索引資料列的所有欄位。</p>
<p>可以拿來索引的東西有：</p>
<ul>
<li><code class="sourceCode python">Slice</code> 物件（也就是平常在使用的 <code class="sourceCode python">start:stop[:step]</code> 這個語法實際產生的東西）</li>
<li>整數值</li>
<li>內含整數的串列</li>
<li>以及內含布林值的串列（例如 <code class="sourceCode python">[<span class="va">True</span>, <span class="va">True</span>, <span class="va">False</span>, ... ]</code> ）</li>
</ul>
</section>
<section id="名稱索引-dataframe.locloc" class="level4">
<h4>名稱索引： <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.loc.html"><code class="sourceCode python">DataFrame.loc</code></a></h4>
<p><code class="sourceCode python">iloc</code> 屬性提供數字方式的索引，<code class="sourceCode python">DataFrame</code> 的 <code class="sourceCode python">loc</code> 屬性提供使用欄與列的名稱來進行索引。</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">22</span>]: df.loc[[<span class="st">&#39;Mr. Hole&#39;</span>, <span class="st">&#39;-273 C&#39;</span>], :<span class="st">&#39;整體評分&#39;</span>]</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">22</span>]:</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>          步行時間（分鐘）           最好吃           整體評分</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>Mr. Hole        <span class="dv">20</span>          咖茲咖茲好吃到噗啾甜甜圈    <span class="fl">8.5</span>   </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="op">-</span><span class="dv">273</span> C          <span class="dv">10</span>                草莓聖代           <span class="fl">7.0</span>   </span></code></pre></div>
<p>索引 「 Mr. Hole 」 及 「 -273 C 」這兩列中的 「整體評分」以前的所有欄位。</p>
<p><code class="sourceCode python">loc</code> 與 <code class="sourceCode python">iloc</code> 的索引語法與適用的索引物件一模一樣（不過不是整數，而是用來當索引的物件 — 字串、時間日期等等），唯一要注意的是， <strong><code class="sourceCode python">loc</code> 的 <code class="sourceCode python">Slice</code> 物件包含上界</strong>。如上例所示， <code class="sourceCode python">Slice</code> 切取到「整體評分」會把「整體評分」本身也包含進去。</p>
</section>
<section id="隨機抽樣-dataframe.samplesample" class="level4">
<h4>隨機抽樣 <a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.sample.html"><code class="sourceCode python">DataFrame.sample</code></a></h4>
<p>如果不想看頭、尾，但是也只是想看看其中一部份的資料列，又或者需要隨機的抽取其中幾筆資料，<code class="sourceCode python">smaple</code> 方法是我們好朋友。</p>
<p>抽取 5 筆資料：</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">23</span>]: covid.sample(<span class="dv">5</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">23</span>]:</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>            確定病名       個案研判日   縣市    鄉鎮  性別 是否為境外移入    年齡層  確定病例數</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="dv">10547</span>  嚴重特殊傳染性肺炎  <span class="dv">2021</span><span class="op">/</span><span class="dv">07</span><span class="op">/</span><span class="dv">05</span>  台北市  萬華區  女       否            <span class="dv">55</span><span class="op">-</span><span class="dv">59</span>      <span class="dv">1</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="dv">10653</span>  嚴重特殊傳染性肺炎  <span class="dv">2021</span><span class="op">/</span><span class="dv">07</span><span class="op">/</span><span class="dv">09</span>  台北市  大同區  男       否            <span class="dv">25</span><span class="op">-</span><span class="dv">29</span>      <span class="dv">1</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="dv">3301</span>   嚴重特殊傳染性肺炎  <span class="dv">2021</span><span class="op">/</span><span class="dv">05</span><span class="op">/</span><span class="dv">25</span>  台北市  內湖區  男       否            <span class="dv">65</span><span class="op">-</span><span class="dv">69</span>      <span class="dv">1</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="dv">6861</span>   嚴重特殊傳染性肺炎  <span class="dv">2021</span><span class="op">/</span><span class="dv">06</span><span class="op">/</span><span class="dv">05</span>  台中市  霧峰區  女       否              <span class="dv">5</span><span class="op">-</span><span class="dv">9</span>      <span class="dv">2</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="dv">335</span>    嚴重特殊傳染性肺炎  <span class="dv">2020</span><span class="op">/</span><span class="dv">07</span><span class="op">/</span><span class="dv">17</span>   空值    空值   男       是            <span class="dv">40</span><span class="op">-</span><span class="dv">44</span>      <span class="dv">1</span></span></code></pre></div>
<p>抽取萬分之三的資料：</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">24</span>]: covid.sample(frac<span class="op">=</span><span class="fl">.0003</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">24</span>]:</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>           確定病名       個案研判日   縣市   鄉鎮   性別 是否為境外移入    年齡層  確定病例數</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="dv">7496</span>  嚴重特殊傳染性肺炎  <span class="dv">2021</span><span class="op">/</span><span class="dv">06</span><span class="op">/</span><span class="dv">07</span>  新北市  中和區  女       否            <span class="dv">65</span><span class="op">-</span><span class="dv">69</span>      <span class="dv">1</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="dv">8009</span>  嚴重特殊傳染性肺炎  <span class="dv">2021</span><span class="op">/</span><span class="dv">06</span><span class="op">/</span><span class="dv">10</span>  南投縣  草屯鎮  男       否            <span class="dv">40</span><span class="op">-</span><span class="dv">44</span>      <span class="dv">1</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="dv">6360</span>  嚴重特殊傳染性肺炎  <span class="dv">2021</span><span class="op">/</span><span class="dv">06</span><span class="op">/</span><span class="dv">03</span>  桃園市  桃園區  男       否              <span class="dv">70</span><span class="op">+</span>      <span class="dv">1</span></span></code></pre></div>
<p>利用百分比隨機抽選資料的功能在分離訓練集和測試集的時候特別好用。</p>
</section>
</section>
<section id="一點小小的統計也許有用" class="level3">
<h3>一點小小的統計也許有用</h3>
<p><code class="sourceCode python">DataFrame</code> 與 <code class="sourceCode python">Series</code> 實作了不少統計與計算相關的方法，讓我們使用者方便不少。</p>
<section id="我想知道資料的某一欄缺了多少資料" class="level4">
<h4>我想知道資料的某一欄缺了多少資料</h4>
<p><a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.isna.html"><code class="sourceCode python">isna</code></a> 這個方法可以回傳一個相同大小的 <code class="sourceCode python">DataFrame</code> 或 <code class="sourceCode python">Series</code> ，用<code class="sourceCode python"><span class="va">True</span></code> 和 <code class="sourceCode python"><span class="va">False</span></code> 標示出哪些地方是缺失值。由於 <code class="sourceCode python"><span class="va">True</span></code> 在加法運算中視為整數 1 ； <code class="sourceCode python"><span class="va">False</span></code> 在加法運算中視為整數 0 。我們可以利用 <code class="sourceCode python"><span class="bu">sum</span></code> 方法來獲知某一欄的缺失值有幾個。</p>
<p>以我們的 covid 資料表為例：</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">25</span>]: covid.head()</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">25</span>]:</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>        確定病名       個案研判日  縣市  鄉鎮 性別 是否為境外移入    年齡層  確定病例數</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>  嚴重特殊傳染性肺炎  <span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">22</span>  空值  空值  女       是            <span class="dv">55</span><span class="op">-</span><span class="dv">59</span>      <span class="dv">1</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>  嚴重特殊傳染性肺炎  <span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">24</span>  空值  空值  女       是            <span class="dv">50</span><span class="op">-</span><span class="dv">54</span>      <span class="dv">1</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>  嚴重特殊傳染性肺炎  <span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">24</span>  空值  空值  男       是            <span class="dv">55</span><span class="op">-</span><span class="dv">59</span>      <span class="dv">1</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>  嚴重特殊傳染性肺炎  <span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">26</span>  空值  空值  女       是            <span class="dv">55</span><span class="op">-</span><span class="dv">59</span>      <span class="dv">1</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>  嚴重特殊傳染性肺炎  <span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">27</span>  空值  空值  女       是            <span class="dv">50</span><span class="op">-</span><span class="dv">54</span>      <span class="dv">1</span></span></code></pre></div>
<p>我們來找「縣市」這欄的缺失值有幾個：</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">26</span>]: covid.縣市.isna().<span class="bu">sum</span>()</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">26</span>]: <span class="dv">0</span></span></code></pre></div>
<p>（這裡用的是 <code class="sourceCode python">Series</code> 的 <a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.isna.html"><code class="sourceCode python">isna</code></a> ）</p>
<p>0 個！怎麼會這樣？上面不是都說「空值」了嗎？<br />
沒有錯，欄位裡面是寫「空值」，但是那是中文字的「空值」。對 Pandas 來說（事實上對任何程式語言來說），內容為「空值」的字串是有值的。<br />
用來標示空值的符號可以是 <code class="sourceCode python">pandas.NA</code> 、 <code class="sourceCode python">pandas.NaT</code> （用於日期格式缺失）、 <code class="sourceCode python"><span class="va">None</span></code> 等等類型。</p>
<p>所以這裡我們要用 <a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.isin.html"><code class="sourceCode python">isin</code></a> ：</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">27</span>]: covid.縣市.isin([<span class="st">&#39;空值&#39;</span>]).<span class="bu">sum</span>()</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">27</span>]: <span class="dv">1044</span></span></code></pre></div>
<p>「縣市」這欄總共有 1,044 筆資料是「空值」。我們可以進一步利用這個結果：</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">28</span>]: covid.縣市.isin([<span class="st">&#39;空值&#39;</span>]).<span class="bu">sum</span>() <span class="op">/</span> covid.縣市.count()</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">28</span>]: <span class="fl">0.09487459105779716</span></span></code></pre></div>
<p>只有百分之九點四的值是「空值」。看來剛剛一直只看前面幾個，好像縣市都是「空值」這個印象是錯誤的。（事實上唯有境外移入才會被紀錄為「空值」）</p>
</section>
<section id="我想知道確定病例數最多的幾個個案" class="level4">
<h4>我想知道確定病例數最多的幾個個案</h4>
<p>「確定病例數」這一欄是個數字，我們可以利用 <a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.sort_values.html"><code class="sourceCode python">sort_values</code></a> 方法來協助我們。</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">29</span>]: covid.確定病例數.sort_values().tail()</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">29</span>]:</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="dv">3026</span>    <span class="dv">18</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="dv">1366</span>    <span class="dv">20</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2386</span>    <span class="dv">20</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2385</span>    <span class="dv">21</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="dv">7254</span>    <span class="dv">23</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>Name: 確定病例數, dtype: int64</span></code></pre></div>
<p><code class="sourceCode python">sort_values</code> 預設行為是數字越大越後面，我們可以利用 <code class="sourceCode python">tail</code> 方法來查看最後面（也就是最大）的幾個。<br />
這邊需要注意的是，正好「確定病例數」這一欄並沒有缺失值，如果有，預設情況下會是放在最後面。這時候我們就需要一些前置處理改善情況。</p>
<p>既然都抓到最大幾筆的個案，我們來看看它們：</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">30</span>]: largest_ones <span class="op">=</span> covid.確定病例數.sort_values().tail().index</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">31</span>]: covid.loc[largest_ones]</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">31</span>]:</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>           確定病名       個案研判日   縣市   鄉鎮   性別 是否為境外移入    年齡層  確定病例數</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="dv">3026</span>  嚴重特殊傳染性肺炎  <span class="dv">2021</span><span class="op">/</span><span class="dv">05</span><span class="op">/</span><span class="dv">24</span>  台北市  萬華區  女       否            <span class="dv">50</span><span class="op">-</span><span class="dv">54</span>     <span class="dv">18</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="dv">1366</span>  嚴重特殊傳染性肺炎  <span class="dv">2021</span><span class="op">/</span><span class="dv">05</span><span class="op">/</span><span class="dv">17</span>  台北市  萬華區  女       否            <span class="dv">50</span><span class="op">-</span><span class="dv">54</span>     <span class="dv">20</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2386</span>  嚴重特殊傳染性肺炎  <span class="dv">2021</span><span class="op">/</span><span class="dv">05</span><span class="op">/</span><span class="dv">22</span>  台北市  萬華區  女       否            <span class="dv">55</span><span class="op">-</span><span class="dv">59</span>     <span class="dv">20</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="dv">2385</span>  嚴重特殊傳染性肺炎  <span class="dv">2021</span><span class="op">/</span><span class="dv">05</span><span class="op">/</span><span class="dv">22</span>  台北市  萬華區  女       否            <span class="dv">50</span><span class="op">-</span><span class="dv">54</span>     <span class="dv">21</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="dv">7254</span>  嚴重特殊傳染性肺炎  <span class="dv">2021</span><span class="op">/</span><span class="dv">06</span><span class="op">/</span><span class="dv">06</span>  苗栗縣  竹南鎮  男       否            <span class="dv">30</span><span class="op">-</span><span class="dv">34</span>     <span class="dv">23</span></span></code></pre></div>
<p>最大五筆裡面有四筆是台北市萬華區，也差不多是 2021 年疫情爆發的初期，與印象相符。</p>
</section>
</section>
<section id="我要怎麼過濾出我要的資料就好" class="level3">
<h3>我要怎麼過濾出我要的資料就好？</h3>
<section id="用邏輯運算產生過濾器" class="level4">
<h4>用邏輯運算產生過濾器</h4>
<p>上面我提到「經過觀察後，我們會發現第一欄『確定病名』全部都是『嚴重特殊傳染性肺炎』」。這件事是真的嗎？還是我騙了你呢？現在我們就來檢驗這件事。</p>
<p>首先我們要知道（如上面 <code class="sourceCode python">isna</code> 章節所述），對 <code class="sourceCode python">Series</code> 進行邏輯運算，回傳的結果會是個同樣長度的 <code class="sourceCode python">Series</code> ，並且內容是各個元素進行邏輯運算的結果。</p>
<p>舉例來說，我們有這個 <code class="sourceCode python">Series</code> ：</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">32</span>]: s <span class="op">=</span> pd.Series([<span class="dv">1</span>, <span class="op">-</span><span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="op">-</span><span class="dv">5</span>])</span></code></pre></div>
<p>對 s 做邏輯運算：</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">33</span>]: s_filter <span class="op">=</span> s <span class="op">&lt;</span> <span class="dv">0</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">34</span>]: s_filter</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">34</span>]:</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>    <span class="va">False</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>     <span class="va">True</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>    <span class="va">False</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>    <span class="va">False</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>     <span class="va">True</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>dtype: <span class="bu">bool</span></span></code></pre></div>
<p>我們會得到一排 <code class="sourceCode python"><span class="va">True</span></code> 與 <code class="sourceCode python"><span class="va">False</span></code> 。<br />
這排 <code class="sourceCode python"><span class="va">True</span></code> 與 <code class="sourceCode python"><span class="va">False</span></code> 正巧是 s 的索引可以接受的東西：</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">35</span>]: s[s_filter]</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">35</span>]:</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>   <span class="op">-</span><span class="dv">3</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>   <span class="op">-</span><span class="dv">5</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>dtype: int64</span></code></pre></div>
<p>這樣子我們就把任何小於零的元素過濾出來了。</p>
<p>同理，我們來看看「確定病名」不為「嚴重特殊傳染性肺炎」的資料列有幾列吧！</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">36</span>]: covid.確定病名[covid.確定病名 <span class="op">!=</span> <span class="st">&#39;嚴重特殊傳染性肺炎&#39;</span>].count()</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">36</span>]: <span class="dv">0</span></span></code></pre></div>
<p>0 。我沒有騙你。=)</p>
</section>
<section id="我是東部的朋友我想關心我的家鄉" class="level4">
<h4>我是東部的朋友，我想關心我的家鄉</h4>
<p>所謂東部所指通常是宜蘭縣、花蓮縣、及台東縣。我們將會使用 <a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.isin.html"><code class="sourceCode python">isin</code></a> 方法從「縣市」這欄過濾出地理區域。再藉由計算地區確定病例總數與全台灣確定病例總數的比值推斷東部疫情的嚴重程度。</p>
<p>你問我境外移入的病例算入總數嗎？基於當時花蓮國皇后把從外縣市傳入的病例稱為「境外移入」，我們就通通摻在一起算吧！</p>
<p>首先要挑出東部地區：</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">37</span>]: eastern <span class="op">=</span> covid[covid.縣市.isin([<span class="st">&#39;宜蘭縣&#39;</span>, <span class="st">&#39;花蓮縣&#39;</span>, <span class="st">&#39;台東縣&#39;</span>])]</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">38</span>]: eastern.sample()</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">38</span>]:</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>           確定病名       個案研判日   縣市     鄉鎮   性別 是否為境外移入    年齡層  確定病例數</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="dv">4064</span>  嚴重特殊傳染性肺炎  <span class="dv">2021</span><span class="op">/</span><span class="dv">05</span><span class="op">/</span><span class="dv">27</span>  台東縣  太麻里鄉  女       否            <span class="dv">60</span><span class="op">-</span><span class="dv">64</span>      <span class="dv">1</span></span></code></pre></div>
<p>再來將東部地區病例總數總和拿去除以全台灣病例總數：</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">39</span>]: eastern.確定病例數.<span class="bu">sum</span>() <span class="op">/</span> covid.確定病例數.<span class="bu">sum</span>()</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">39</span>]: <span class="fl">0.012101705825555198</span></span></code></pre></div>
<p>整個東部地區只有佔總病例數的 1.2% ，真的是淨土啊！</p>
<p><code class="sourceCode python">Series.isin</code> 方法可以接受一個串列，並回傳一個等長的 <code class="sourceCode python">Series</code> 標示每個元素是否與該串列內容的其中一個值相同。想要挑選特定的幾個值的話 <code class="sourceCode python">isin</code> 很好用。</p>
</section>
<section id="我要怎麼知道每天的病例數字" class="level4">
<h4>我要怎麼知道每天的病例數字？</h4>
<p>「我看起來常常一天內會有數起個案，每個個案又不一定是同樣數量的病例數，難道我要把每一天都分割出來再加總嗎？」</p>
<p>別擔心！ <code class="sourceCode python">DataFrame</code> 有個方法叫 <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.groupby.html"><code class="sourceCode python">groupby</code></a> 專門做這種事。 <code class="sourceCode python">groupby</code> 可以傳入一個或多個欄位名稱，它會馬上回傳一個 <code class="sourceCode python">SeriesGroupBy</code> 物件。我們不用知道這個物件是什麼，我們只需要知道在概念上，這個 <code class="sourceCode python">DataFrame</code> 已經照著我們的吩咐進行分類了。只是說分類好的數字 Pandas 暫時還不知道要拿他們怎麼辦。</p>
<p>這時我們可以在該物件後面接上欄位名稱與運算方法來產出結果。</p>
<p>也就是說，我們要先把每個資料列照「個案研判日」分群（ <code class="sourceCode python">groupby</code> ），然後針對「確定病例數」這欄加總：</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>n [<span class="dv">148</span>]: covid.groupby(<span class="st">&#39;個案研判日&#39;</span>).確定病例數.<span class="bu">sum</span>()</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">148</span>]:</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>個案研判日</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">22</span>     <span class="dv">1</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">24</span>     <span class="dv">2</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">26</span>     <span class="dv">1</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">27</span>     <span class="dv">1</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">28</span>     <span class="dv">3</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>              ..</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a><span class="dv">2021</span><span class="op">/</span><span class="dv">07</span><span class="op">/</span><span class="dv">18</span>    <span class="dv">18</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a><span class="dv">2021</span><span class="op">/</span><span class="dv">07</span><span class="op">/</span><span class="dv">19</span>    <span class="dv">21</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a><span class="dv">2021</span><span class="op">/</span><span class="dv">07</span><span class="op">/</span><span class="dv">20</span>    <span class="dv">24</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a><span class="dv">2021</span><span class="op">/</span><span class="dv">07</span><span class="op">/</span><span class="dv">21</span>    <span class="dv">58</span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a><span class="dv">2021</span><span class="op">/</span><span class="dv">07</span><span class="op">/</span><span class="dv">22</span>    <span class="dv">24</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>Name: 確定病例數, Length: <span class="dv">379</span>, dtype: int64</span></code></pre></div>
<p>出來的結果就是每日確診病例數字。<br />
證據就是，2020/01/28 這天的三例病例是由兩個個案組成的。</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">40</span>]: covid[covid.個案研判日 <span class="op">==</span> <span class="st">&#39;2020/01/28&#39;</span>]</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">40</span>]:</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>        確定病名       個案研判日   縣市    鄉鎮  性別 是否為境外移入    年齡層  確定病例數</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>  嚴重特殊傳染性肺炎  <span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">28</span>   空值    空值   女       是              <span class="dv">70</span><span class="op">+</span>      <span class="dv">2</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>  嚴重特殊傳染性肺炎  <span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">28</span>  彰化縣  和美鎮   男       否            <span class="dv">50</span><span class="op">-</span><span class="dv">54</span>      <span class="dv">1</span></span></code></pre></div>
<p>接下來，這是用「個案研判日」和「是否為境外移入」兩項標籤分類出的病例數目：</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">41</span>]: covid.groupby([<span class="st">&#39;個案研判日&#39;</span>, <span class="st">&#39;是否為境外移入&#39;</span>]).確定病例數.<span class="bu">sum</span>().head(<span class="dv">10</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">41</span>]:</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>個案研判日       是否為境外移入</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">22</span>             是          <span class="dv">1</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">24</span>             是          <span class="dv">2</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">26</span>             是          <span class="dv">1</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">27</span>             是          <span class="dv">1</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">28</span>             否          <span class="dv">1</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>                       是          <span class="dv">2</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">30</span>             否          <span class="dv">1</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">31</span>             是          <span class="dv">1</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a><span class="dv">2020</span><span class="op">/</span><span class="dv">02</span><span class="op">/</span><span class="dv">04</span>             是          <span class="dv">1</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a><span class="dv">2020</span><span class="op">/</span><span class="dv">02</span><span class="op">/</span><span class="dv">06</span>             是          <span class="dv">3</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>Name: 確定病例數, dtype: int64</span></code></pre></div>
<p>可以看到 2020/01/28 這天有兩個病例是境外移入、一個是本土。</p>
</section>
<section id="那我想同時知道每天的總病例數字和個案數字怎麼辦" class="level4">
<h4>那我想同時知道每天的總病例數字和個案數字怎麼辦？</h4>
<p>請對分群完的欄位使用 <a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.agg.html"><code class="sourceCode python">agg</code></a> 方法。該方法可以接受多個統計或計算方法，並把結果以欄位分開顯示：</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">42</span>]: covid.groupby(<span class="st">&#39;個案研判日&#39;</span>).確定病例數.agg([<span class="st">&#39;count&#39;</span>, <span class="st">&#39;sum&#39;</span>])</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">42</span>]:</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>            count  <span class="bu">sum</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>個案研判日</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">22</span>      <span class="dv">1</span>    <span class="dv">1</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">24</span>      <span class="dv">2</span>    <span class="dv">2</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">26</span>      <span class="dv">1</span>    <span class="dv">1</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">27</span>      <span class="dv">1</span>    <span class="dv">1</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">28</span>      <span class="dv">2</span>    <span class="dv">3</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>...           ...  ...</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="dv">2021</span><span class="op">/</span><span class="dv">07</span><span class="op">/</span><span class="dv">18</span>     <span class="dv">17</span>   <span class="dv">18</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a><span class="dv">2021</span><span class="op">/</span><span class="dv">07</span><span class="op">/</span><span class="dv">19</span>     <span class="dv">20</span>   <span class="dv">21</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a><span class="dv">2021</span><span class="op">/</span><span class="dv">07</span><span class="op">/</span><span class="dv">20</span>     <span class="dv">23</span>   <span class="dv">24</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a><span class="dv">2021</span><span class="op">/</span><span class="dv">07</span><span class="op">/</span><span class="dv">21</span>     <span class="dv">48</span>   <span class="dv">58</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a><span class="dv">2021</span><span class="op">/</span><span class="dv">07</span><span class="op">/</span><span class="dv">22</span>     <span class="dv">21</span>   <span class="dv">24</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>[<span class="dv">379</span> rows x <span class="dv">2</span> columns]</span></code></pre></div>
<p>這裡我們可以看到，例如 2021/07/21 ，有 48 筆個案、 58 筆病例。</p>
<p>由於 <code class="sourceCode python">agg</code> 回傳的是一個 <code class="sourceCode python">Series</code> 或 <code class="sourceCode python">DataFrame</code> ，可以繼續進行加工以獲得更進一步的資訊（例如排序等等）。</p>
</section>
</section>
<section id="透視表-pivot-table-又稱樞紐分析要怎麼做" class="level3">
<h3>透視表（ pivot table ，又稱樞紐分析）要怎麼做？</h3>
<p><a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.pivot_table.html"><code class="sourceCode python">DataFrame.pivot_table</code></a> 方法正是設計來做樞紐分析！</p>
<p>比如說，我想輕鬆的觀察每天的境外移入和本土病例數目：</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">43</span>]: covid.pivot_table(index<span class="op">=</span><span class="st">&#39;個案研判日&#39;</span>, columns<span class="op">=</span><span class="st">&#39;是否為境外移入&#39;</span>, values<span class="op">=</span><span class="st">&#39;確定病例數&#39;</span>, aggfunc<span class="op">=</span><span class="st">&#39;sum&#39;</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">43</span>]:</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>是否為境外移入        否     是</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>個案研判日</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">22</span>         NaN   <span class="fl">1.0</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">24</span>         NaN   <span class="fl">2.0</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">26</span>         NaN   <span class="fl">1.0</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">27</span>         NaN   <span class="fl">1.0</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">28</span>         <span class="fl">1.0</span>   <span class="fl">2.0</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>...                ...   ...</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a><span class="dv">2021</span><span class="op">/</span><span class="dv">07</span><span class="op">/</span><span class="dv">18</span>        <span class="fl">15.0</span>   <span class="fl">3.0</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a><span class="dv">2021</span><span class="op">/</span><span class="dv">07</span><span class="op">/</span><span class="dv">19</span>        <span class="fl">15.0</span>   <span class="fl">6.0</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a><span class="dv">2021</span><span class="op">/</span><span class="dv">07</span><span class="op">/</span><span class="dv">20</span>        <span class="fl">18.0</span>   <span class="fl">6.0</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a><span class="dv">2021</span><span class="op">/</span><span class="dv">07</span><span class="op">/</span><span class="dv">21</span>        <span class="fl">46.0</span>  <span class="fl">12.0</span></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a><span class="dv">2021</span><span class="op">/</span><span class="dv">07</span><span class="op">/</span><span class="dv">22</span>        <span class="fl">23.0</span>   <span class="fl">1.0</span></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>[<span class="dv">379</span> rows x <span class="dv">2</span> columns]</span></code></pre></div>
<p><code class="sourceCode python">index</code> 參數指定透視表的索引欄、<code class="sourceCode python">columns</code> 指定作為透視表欄位的欄位、<code class="sourceCode python">values</code> 指定透視表的數值部份、<code class="sourceCode python">aggfunc</code> 指定索引欄相同的 <code class="sourceCode python">values</code> 值要怎麼合併。</p>
<p>如果需要總合數字，可以將 <code class="sourceCode python">margins</code> 設定為 <code class="sourceCode python"><span class="va">True</span></code> 製作透視表：</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">44</span>]: covid.pivot_table(index<span class="op">=</span><span class="st">&#39;個案研判日&#39;</span>, columns<span class="op">=</span><span class="st">&#39;是否為境外移入&#39;</span>, values<span class="op">=</span><span class="st">&#39;確定病例數&#39;</span>, aggfunc<span class="op">=</span><span class="st">&#39;sum&#39;</span>, margins<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">44</span>]:</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>是否為境外移入            否       是      All</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>個案研判日     </span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">22</span>              NaN     <span class="fl">1.0</span>      <span class="dv">1</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">24</span>              NaN     <span class="fl">2.0</span>      <span class="dv">2</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">26</span>              NaN     <span class="fl">1.0</span>      <span class="dv">1</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">27</span>              NaN     <span class="fl">1.0</span>      <span class="dv">1</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">28</span>              <span class="fl">1.0</span>     <span class="fl">2.0</span>      <span class="dv">3</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>...                     ...     ...    ...</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a><span class="dv">2021</span><span class="op">/</span><span class="dv">07</span><span class="op">/</span><span class="dv">19</span>             <span class="fl">15.0</span>     <span class="fl">6.0</span>     <span class="dv">21</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a><span class="dv">2021</span><span class="op">/</span><span class="dv">07</span><span class="op">/</span><span class="dv">20</span>             <span class="fl">18.0</span>     <span class="fl">6.0</span>     <span class="dv">24</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a><span class="dv">2021</span><span class="op">/</span><span class="dv">07</span><span class="op">/</span><span class="dv">21</span>             <span class="fl">46.0</span>    <span class="fl">12.0</span>     <span class="dv">58</span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a><span class="dv">2021</span><span class="op">/</span><span class="dv">07</span><span class="op">/</span><span class="dv">22</span>             <span class="fl">23.0</span>     <span class="fl">1.0</span>     <span class="dv">24</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>All                 <span class="fl">14228.0</span>  <span class="fl">1307.0</span>  <span class="dv">15535</span></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>[<span class="dv">380</span> rows x <span class="dv">3</span> columns]</span></code></pre></div>
<p>如此一來，資料就看得比用 <code class="sourceCode python">groupby</code> 做出來的清楚多了。</p>
</section>
<section id="還是很難理解全局動向我可以畫圖嗎" class="level3">
<h3>還是很難理解全局動向，我可以畫圖嗎？</h3>
<p>Pandas 直接把 API 接到模組裡面，我們只要呼叫 <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.plot.html"><code class="sourceCode python">DataFrame.plot</code></a> 方法就能直接作圖（在 Jupyter Notebook 裡面的話啦…）。</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>covid.pivot_table(index<span class="op">=</span><span class="st">&#39;個案研判日&#39;</span>, </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>                  columns<span class="op">=</span><span class="st">&#39;是否為境外移入&#39;</span>, </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>                  values<span class="op">=</span><span class="st">&#39;確定病例數&#39;</span>,</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>                  aggfunc<span class="op">=</span><span class="st">&#39;sum&#39;</span>).plot(xlabel<span class="op">=</span><span class="st">&#39;&#39;</span>, </span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>                                      figsize<span class="op">=</span>(<span class="dv">50</span>, <span class="dv">25</span>), </span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>                                      fontsize<span class="op">=</span><span class="st">&#39;40&#39;</span>,</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>                                      legend<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>                                      grid<span class="op">=</span><span class="va">True</span>, </span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>                                      yticks<span class="op">=</span><span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">801</span>, <span class="dv">100</span>))</span></code></pre></div>
<p><img src="./media/pandas-plot-example.jpg" /></p>
<p>橘色線是境外移入、藍色線是本土。老實說我遇到中文字型不支援的麻煩，所以我把圖標和橫軸都關掉了。<br />
從這張圖可以清楚看見，在 2021 年五月中之前臺灣的疫情其實控制的相當好。</p>
<p>Pandas 繪圖依賴的是 Matplotlib ，當我們呼叫 <code class="sourceCode python">DataFrame.plot</code> 方法時可以當作在呼叫 <code class="sourceCode python">Matplotpib.pyplot.plot</code> 這個函式，只不過資料可以交由 Pandas 自動送入。</p>
<p>另外，若不習慣用 <code class="sourceCode python">kind</code> 參數指定繪圖類型的話，我們可以用 <code class="sourceCode python">DataFrame.plot.scatter</code> 畫出散點圖、 <code class="sourceCode python">DataFrame.plot.hist</code> 畫出長條圖、<code class="sourceCode python">DataFrame.plot.area</code> 畫出面積圖等等。詳細的所有方法<a href="https://pandas.pydata.org/docs/reference/frame.html#plotting">請參考這裡</a></p>
<p><code class="sourceCode python">plot</code> 方法雖然很方便，但是選擇有限。作為一個快速觀察很方便，但是要發揮全部的繪圖威力還是得使用專門繪圖的套件。</p>
</section>
</section>
<section id="原始表格不符需求我要怎麼改動它" class="level2">
<h2>原始表格不符需求，我要怎麼改動它？</h2>
<section id="我要怎麼刪除或新增我需要的欄位" class="level3">
<h3>我要怎麼刪除或新增我需要的欄位？</h3>
<section id="刪除欄位" class="level4">
<h4>刪除欄位</h4>
<p>稍早我們確認「確定病名」這欄的所有資料都一模一樣。換句話說，這一欄基本上沒有存在的必要。我們現在來刪除它：</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">45</span>]: <span class="kw">del</span> covid[<span class="st">&#39;確定病名&#39;</span>]</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">46</span>]: covid.head()</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">46</span>]:</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>        個案研判日  縣市  鄉鎮 性別   是否為境外移入      年齡層  確定病例數</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>       <span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">22</span>  空值  空值  女       是            <span class="dv">55</span><span class="op">-</span><span class="dv">59</span>      <span class="dv">1</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>       <span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">24</span>  空值  空值  女       是            <span class="dv">50</span><span class="op">-</span><span class="dv">54</span>      <span class="dv">1</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>       <span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">24</span>  空值  空值  男       是            <span class="dv">55</span><span class="op">-</span><span class="dv">59</span>      <span class="dv">1</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>       <span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">26</span>  空值  空值  女       是            <span class="dv">55</span><span class="op">-</span><span class="dv">59</span>      <span class="dv">1</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>       <span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">27</span>  空值  空值  女       是            <span class="dv">50</span><span class="op">-</span><span class="dv">54</span>      <span class="dv">1</span></span></code></pre></div>
<p><code class="sourceCode python"><span class="kw">del</span></code> 陳述句與 <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.drop.html"><code class="sourceCode python">drop</code></a> 方法都可以做到刪除欄位的效果，刪除列也是。</p>
</section>
<section id="新增欄位" class="level4">
<h4>新增欄位</h4>
<p>為 <code class="sourceCode python">DataFrame</code> 新增欄位的方式跟字典一模一樣：</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">47</span>]: covid[<span class="st">&#39;new_col&#39;</span>] <span class="op">=</span> <span class="bu">range</span>(<span class="bu">len</span>(covid))</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">48</span>]: covid.tail()</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">48</span>]:</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>            個案研判日   縣市   鄉鎮   性別   是否為境外移入      年齡層  確定病例數    new_col</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="dv">10999</span>       <span class="dv">2021</span><span class="op">/</span><span class="dv">07</span><span class="op">/</span><span class="dv">22</span>  新北市  板橋區  男       否            <span class="dv">25</span><span class="op">-</span><span class="dv">29</span>      <span class="dv">1</span>        <span class="dv">10999</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="dv">11000</span>       <span class="dv">2021</span><span class="op">/</span><span class="dv">07</span><span class="op">/</span><span class="dv">22</span>  新北市  板橋區  男       否            <span class="dv">30</span><span class="op">-</span><span class="dv">34</span>      <span class="dv">1</span>        <span class="dv">11000</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="dv">11001</span>       <span class="dv">2021</span><span class="op">/</span><span class="dv">07</span><span class="op">/</span><span class="dv">22</span>  新北市  泰山區  男       否            <span class="dv">45</span><span class="op">-</span><span class="dv">49</span>      <span class="dv">1</span>        <span class="dv">11001</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a><span class="dv">11002</span>       <span class="dv">2021</span><span class="op">/</span><span class="dv">07</span><span class="op">/</span><span class="dv">22</span>  新北市  淡水區  男       否            <span class="dv">35</span><span class="op">-</span><span class="dv">39</span>      <span class="dv">1</span>        <span class="dv">11002</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a><span class="dv">11003</span>       <span class="dv">2021</span><span class="op">/</span><span class="dv">07</span><span class="op">/</span><span class="dv">22</span>  新北市  樹林區  女       否            <span class="dv">35</span><span class="op">-</span><span class="dv">39</span>      <span class="dv">1</span>        <span class="dv">11003</span></span></code></pre></div>
<p>這種方式建立的欄位會接在整個表的最最右邊。如果想要把資料欄安放在中間的位置，請使用 <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.insert.html"><code class="sourceCode python">insert</code></a> 方法。</p>
</section>
</section>
<section id="中文英文一直來回切換好麻煩喔我要重新命名欄位名稱" class="level3">
<h3>中文英文一直來回切換好麻煩喔！我要重新命名欄位名稱</h3>
<p><code class="sourceCode python">DataFrame</code> 的 <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.rename.html"><code class="sourceCode python">rename</code></a> 方法可以輕鬆的命名欄與列的名稱：</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">49</span>]: covid <span class="op">=</span> covid.rename(columns<span class="op">=</span>{<span class="st">&#39;個案研判日&#39;</span>: <span class="st">&#39;Date&#39;</span>,</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>    ...:                               <span class="st">&#39;縣市&#39;</span>: <span class="st">&#39;City/Country&#39;</span>,</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>    ...:                               <span class="st">&#39;鄉鎮&#39;</span>: <span class="st">&#39;Township&#39;</span>,</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>    ...:                               <span class="st">&#39;性別&#39;</span>: <span class="st">&#39;Sex&#39;</span>,</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>    ...:                               <span class="st">&#39;是否為境外移入&#39;</span>: <span class="st">&#39;Local/Abroad&#39;</span>,</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>    ...:                               <span class="st">&#39;年齡層&#39;</span>: <span class="st">&#39;Age_group&#39;</span>,</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>    ...:                               <span class="st">&#39;確定病例數&#39;</span>: <span class="st">&#39;Case&#39;</span>})</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">12</span>]:</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>             Date      City<span class="op">/</span>Country Township   Sex  Local<span class="op">/</span>Abroad Age_group  Case  new_col</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>      <span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">22</span>           空值       空值     女            是     <span class="dv">55</span><span class="op">-</span><span class="dv">59</span>     <span class="dv">1</span>        <span class="dv">0</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>      <span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">24</span>           空值       空值     女            是     <span class="dv">50</span><span class="op">-</span><span class="dv">54</span>     <span class="dv">1</span>        <span class="dv">1</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>      <span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">24</span>           空值       空值     男            是     <span class="dv">55</span><span class="op">-</span><span class="dv">59</span>     <span class="dv">1</span>        <span class="dv">2</span></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>      <span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">26</span>           空值       空值     女            是     <span class="dv">55</span><span class="op">-</span><span class="dv">59</span>     <span class="dv">1</span>        <span class="dv">3</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>      <span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">27</span>           空值       空值     女            是     <span class="dv">50</span><span class="op">-</span><span class="dv">54</span>     <span class="dv">1</span>        <span class="dv">4</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>...           ...            ...        ...     ..           ...       ...   ...      ...</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a><span class="dv">10999</span>  <span class="dv">2021</span><span class="op">/</span><span class="dv">07</span><span class="op">/</span><span class="dv">22</span>          新北市      板橋區    男            否     <span class="dv">25</span><span class="op">-</span><span class="dv">29</span>     <span class="dv">1</span>     <span class="dv">10999</span></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a><span class="dv">11000</span>  <span class="dv">2021</span><span class="op">/</span><span class="dv">07</span><span class="op">/</span><span class="dv">22</span>          新北市      板橋區    男            否     <span class="dv">30</span><span class="op">-</span><span class="dv">34</span>     <span class="dv">1</span>     <span class="dv">11000</span></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a><span class="dv">11001</span>  <span class="dv">2021</span><span class="op">/</span><span class="dv">07</span><span class="op">/</span><span class="dv">22</span>          新北市      泰山區    男            否     <span class="dv">45</span><span class="op">-</span><span class="dv">49</span>     <span class="dv">1</span>     <span class="dv">11001</span></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a><span class="dv">11002</span>  <span class="dv">2021</span><span class="op">/</span><span class="dv">07</span><span class="op">/</span><span class="dv">22</span>          新北市      淡水區    男            否     <span class="dv">35</span><span class="op">-</span><span class="dv">39</span>     <span class="dv">1</span>     <span class="dv">11002</span></span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a><span class="dv">11003</span>  <span class="dv">2021</span><span class="op">/</span><span class="dv">07</span><span class="op">/</span><span class="dv">22</span>          新北市      樹林區    女            否     <span class="dv">35</span><span class="op">-</span><span class="dv">39</span>     <span class="dv">1</span>     <span class="dv">11003</span></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>[<span class="dv">11004</span> rows x <span class="dv">8</span> columns]</span></code></pre></div>
</section>
<section id="我要怎麼用自定義函式改動欄位" class="level3">
<h3>我要怎麼用自定義函式改動欄位？</h3>
<p>「我是瑪雅人，使用二十進位是我的驕傲！」</p>
<p>沒有問題，我們把數字都轉成 20 進位。<br />
首先我們先定義 20 進位的數字為「 0 1 2 3 4 5 6 7 8 9 A B C D E F G H I J 」，再來我們需要一個轉換器：</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">50</span>]: <span class="kw">def</span> dec_to_vig(n):</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>   ...:     a <span class="op">=</span> [<span class="st">&#39;0&#39;</span>, <span class="st">&#39;1&#39;</span>, <span class="st">&#39;2&#39;</span>, <span class="st">&#39;3&#39;</span>, <span class="st">&#39;4&#39;</span>, <span class="st">&#39;5&#39;</span>, <span class="st">&#39;6&#39;</span>, <span class="st">&#39;7&#39;</span>, <span class="st">&#39;8&#39;</span>, <span class="st">&#39;9&#39;</span>,</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>   ...:          <span class="st">&#39;A&#39;</span>, <span class="st">&#39;B&#39;</span>, <span class="st">&#39;C&#39;</span>, <span class="st">&#39;D&#39;</span>, <span class="st">&#39;E&#39;</span>, <span class="st">&#39;F&#39;</span>, <span class="st">&#39;G&#39;</span>, <span class="st">&#39;H&#39;</span>, <span class="st">&#39;I&#39;</span>, <span class="st">&#39;J&#39;</span>]</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>   ...:     res <span class="op">=</span> []</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>   ...:     <span class="cf">while</span> n <span class="op">//</span> <span class="dv">20</span> <span class="op">&gt;=</span> <span class="dv">1</span>:</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>   ...:         res.append(a[n <span class="op">%</span> <span class="dv">20</span>])</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>   ...:         n <span class="op">//=</span> <span class="dv">20</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>   ...:     <span class="cf">if</span> n <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>   ...:         res.append(a[n])</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>   ...:     <span class="cf">return</span> <span class="st">&#39;&#39;</span>.join(res[::<span class="op">-</span><span class="dv">1</span>])</span></code></pre></div>
<p>接著我們要把這個函式套用在欄位中的每一個元素，這個步驟需要 <a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.apply.html"><code class="sourceCode python"><span class="bu">apply</span></code></a> 這個方法來幫忙：</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">51</span>]: covid_maya <span class="op">=</span> covid.copy()</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">52</span>]: covid_maya[<span class="st">&#39;Case&#39;</span>] <span class="op">=</span> covid_maya[<span class="st">&#39;Case&#39;</span>].<span class="bu">apply</span>(dec_to_vig)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">53</span>]: covid_maya.loc[covid.sort_values(<span class="st">&#39;Case&#39;</span>).tail().index]</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">53</span>]:</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>            Date    City<span class="op">/</span>Country    Township  Sex  Local<span class="op">/</span>Abroad Age_group Case  new_col</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="dv">3026</span>  <span class="dv">2021</span><span class="op">/</span><span class="dv">05</span><span class="op">/</span><span class="dv">24</span>          台北市      萬華區   女            否     <span class="dv">50</span><span class="op">-</span><span class="dv">54</span>    I     <span class="dv">3026</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="dv">1366</span>  <span class="dv">2021</span><span class="op">/</span><span class="dv">05</span><span class="op">/</span><span class="dv">17</span>          台北市      萬華區   女            否     <span class="dv">50</span><span class="op">-</span><span class="dv">54</span>   <span class="dv">10</span>     <span class="dv">1366</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a><span class="dv">2386</span>  <span class="dv">2021</span><span class="op">/</span><span class="dv">05</span><span class="op">/</span><span class="dv">22</span>          台北市      萬華區   女            否     <span class="dv">55</span><span class="op">-</span><span class="dv">59</span>   <span class="dv">10</span>     <span class="dv">2386</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a><span class="dv">2385</span>  <span class="dv">2021</span><span class="op">/</span><span class="dv">05</span><span class="op">/</span><span class="dv">22</span>          台北市      萬華區   女            否     <span class="dv">50</span><span class="op">-</span><span class="dv">54</span>   <span class="dv">11</span>     <span class="dv">2385</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a><span class="dv">7254</span>  <span class="dv">2021</span><span class="op">/</span><span class="dv">06</span><span class="op">/</span><span class="dv">06</span>          苗栗縣      竹南鎮   男            否     <span class="dv">30</span><span class="op">-</span><span class="dv">34</span>   <span class="dv">13</span>     <span class="dv">7254</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">54</span>]: covid.sort_values(<span class="st">&#39;Case&#39;</span>).tail()</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">54</span>]:</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>            Date    City<span class="op">/</span>Country    Township  Sex  Local<span class="op">/</span>Abroad Age_group  Case  new_col</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a><span class="dv">3026</span>  <span class="dv">2021</span><span class="op">/</span><span class="dv">05</span><span class="op">/</span><span class="dv">24</span>          台北市      萬華區   女            否     <span class="dv">50</span><span class="op">-</span><span class="dv">54</span>    <span class="dv">18</span>     <span class="dv">3026</span></span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a><span class="dv">1366</span>  <span class="dv">2021</span><span class="op">/</span><span class="dv">05</span><span class="op">/</span><span class="dv">17</span>          台北市      萬華區   女            否     <span class="dv">50</span><span class="op">-</span><span class="dv">54</span>    <span class="dv">20</span>     <span class="dv">1366</span></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a><span class="dv">2386</span>  <span class="dv">2021</span><span class="op">/</span><span class="dv">05</span><span class="op">/</span><span class="dv">22</span>          台北市      萬華區   女            否     <span class="dv">55</span><span class="op">-</span><span class="dv">59</span>    <span class="dv">20</span>     <span class="dv">2386</span></span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a><span class="dv">2385</span>  <span class="dv">2021</span><span class="op">/</span><span class="dv">05</span><span class="op">/</span><span class="dv">22</span>          台北市      萬華區   女            否     <span class="dv">50</span><span class="op">-</span><span class="dv">54</span>    <span class="dv">21</span>     <span class="dv">2385</span></span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a><span class="dv">7254</span>  <span class="dv">2021</span><span class="op">/</span><span class="dv">06</span><span class="op">/</span><span class="dv">06</span>          苗栗縣      竹南鎮   男            否     <span class="dv">30</span><span class="op">-</span><span class="dv">34</span>    <span class="dv">23</span>     <span class="dv">7254</span></span></code></pre></div>
<p>這樣就完成「 Case 」這一欄了！</p>
<p>什麼？其他欄？身為驕傲的瑪雅人你應該自己完成！</p>
</section>
<section id="我要怎麼合併兩張表" class="level3">
<h3>我要怎麼合併兩張表？</h3>
<section id="單純疊放在一起" class="level4">
<h4>單純疊放在一起</h4>
<p>例如說，我很無聊，我把最後五列疊放在最上面：</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">55</span>]: covid2 <span class="op">=</span> covid.copy()[<span class="op">-</span><span class="dv">5</span>:]</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">56</span>]: pd.concat([covid2, covid]).head(<span class="dv">10</span>)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">56</span>]:</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>            確定病名       個案研判日   縣市    鄉鎮  性別 是否為境外移入    年齡層  確定病例數</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="dv">10999</span>  嚴重特殊傳染性肺炎  <span class="dv">2021</span><span class="op">/</span><span class="dv">07</span><span class="op">/</span><span class="dv">22</span>  新北市  板橋區  男       否            <span class="dv">25</span><span class="op">-</span><span class="dv">29</span>      <span class="dv">1</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="dv">11000</span>  嚴重特殊傳染性肺炎  <span class="dv">2021</span><span class="op">/</span><span class="dv">07</span><span class="op">/</span><span class="dv">22</span>  新北市  板橋區  男       否            <span class="dv">30</span><span class="op">-</span><span class="dv">34</span>      <span class="dv">1</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="dv">11001</span>  嚴重特殊傳染性肺炎  <span class="dv">2021</span><span class="op">/</span><span class="dv">07</span><span class="op">/</span><span class="dv">22</span>  新北市  泰山區  男       否            <span class="dv">45</span><span class="op">-</span><span class="dv">49</span>      <span class="dv">1</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a><span class="dv">11002</span>  嚴重特殊傳染性肺炎  <span class="dv">2021</span><span class="op">/</span><span class="dv">07</span><span class="op">/</span><span class="dv">22</span>  新北市  淡水區  男       否            <span class="dv">35</span><span class="op">-</span><span class="dv">39</span>      <span class="dv">1</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a><span class="dv">11003</span>  嚴重特殊傳染性肺炎  <span class="dv">2021</span><span class="op">/</span><span class="dv">07</span><span class="op">/</span><span class="dv">22</span>  新北市  樹林區  女       否            <span class="dv">35</span><span class="op">-</span><span class="dv">39</span>      <span class="dv">1</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>      嚴重特殊傳染性肺炎  <span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">22</span>   空值    空值   女       是            <span class="dv">55</span><span class="op">-</span><span class="dv">59</span>      <span class="dv">1</span></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>      嚴重特殊傳染性肺炎  <span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">24</span>   空值    空值   女       是            <span class="dv">50</span><span class="op">-</span><span class="dv">54</span>      <span class="dv">1</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>      嚴重特殊傳染性肺炎  <span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">24</span>   空值    空值   男       是            <span class="dv">55</span><span class="op">-</span><span class="dv">59</span>      <span class="dv">1</span></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>      嚴重特殊傳染性肺炎  <span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">26</span>   空值    空值   女       是            <span class="dv">55</span><span class="op">-</span><span class="dv">59</span>      <span class="dv">1</span></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>      嚴重特殊傳染性肺炎  <span class="dv">2020</span><span class="op">/</span><span class="dv">01</span><span class="op">/</span><span class="dv">27</span>   空值    空值   女       是            <span class="dv">50</span><span class="op">-</span><span class="dv">54</span>      <span class="dv">1</span></span></code></pre></div>
<p>利用 <a href="https://pandas.pydata.org/docs/reference/api/pandas.concat.html"><code class="sourceCode python">pandas.concat</code></a> 可以許多個表疊放在一起。 <code class="sourceCode python">concat</code> 的輸入的串列中，第一個 <code class="sourceCode python">DataFrame</code> 會放在最上面，再來是第二個、第三個，以此類推。預設方向是垂直疊放，若需要水平疊放請把位置參數 <code class="sourceCode python">axis</code> 設為 1 。</p>
<p>疊放有兩點要注意：首先，它並不主動合併索引值、第二，若資料並不整齊，缺失值 Pandas 會用 <code class="sourceCode python">pandas.NA</code> 補上。</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">57</span>]: df2 <span class="op">=</span> pd.DataFrame({<span class="dv">0</span>: [<span class="dv">1</span>, <span class="dv">2</span>], <span class="dv">1</span>: [<span class="dv">3</span>, <span class="dv">4</span>]})</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">58</span>]: df3 <span class="op">=</span> pd.DataFrame({<span class="dv">0</span>: [<span class="dv">5</span>], <span class="dv">1</span>: [<span class="dv">6</span>], <span class="dv">2</span>: [<span class="dv">7</span>]})</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">59</span>]: df2</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">59</span>]:</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>   <span class="dv">0</span>  <span class="dv">1</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>  <span class="dv">1</span>  <span class="dv">3</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>  <span class="dv">2</span>  <span class="dv">4</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">60</span>]: df3</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">60</span>]:</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>   <span class="dv">0</span>  <span class="dv">1</span>  <span class="dv">2</span></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>  <span class="dv">5</span>  <span class="dv">6</span>  <span class="dv">7</span></span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">61</span>]: pd.concat([df2, df3])</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">61</span>]:</span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>   <span class="dv">0</span>  <span class="dv">1</span>    <span class="dv">2</span></span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>  <span class="dv">1</span>  <span class="dv">3</span>  NaN</span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>  <span class="dv">2</span>  <span class="dv">4</span>  NaN</span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>  <span class="dv">5</span>  <span class="dv">6</span>  <span class="fl">7.0</span></span></code></pre></div>
</section>
<section id="依據欄位值不同補充資料" class="level4">
<h4>依據欄位值不同補充資料</h4>
<p>這種方式有點像資料庫連接（ join ）的 SELECT 語句。</p>
<p>比如說，我想依據縣市分類每一個個案在台灣的哪一區塊：</p>
<p>首先，我們來製作補充資料的 <code class="sourceCode python">DataFrame</code> 。</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">62</span>]: area <span class="op">=</span> {</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>    ...:     <span class="st">&#39;花蓮縣&#39;</span>: <span class="st">&#39;東台灣&#39;</span>,</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>    ...:     <span class="st">&#39;台東縣&#39;</span>: <span class="st">&#39;東台灣&#39;</span>,</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>    ...:     <span class="st">&#39;基隆市&#39;</span>: <span class="st">&#39;北台灣&#39;</span>,</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>    ...:     <span class="st">&#39;台北市&#39;</span>: <span class="st">&#39;北台灣&#39;</span>,</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>    ...:     <span class="st">&#39;新北市&#39;</span>: <span class="st">&#39;北台灣&#39;</span>,</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>    ...:     <span class="st">&#39;桃園市&#39;</span>: <span class="st">&#39;北台灣&#39;</span>,</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>    ...:     <span class="st">&#39;新竹市&#39;</span>: <span class="st">&#39;北台灣&#39;</span>,</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>    ...:     <span class="st">&#39;新竹縣&#39;</span>: <span class="st">&#39;北台灣&#39;</span>,</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>    ...:     <span class="st">&#39;宜蘭縣&#39;</span>: <span class="st">&#39;北台灣&#39;</span>,</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>    ...:     <span class="st">&#39;苗栗縣&#39;</span>: <span class="st">&#39;中臺灣&#39;</span>,</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>    ...:     <span class="st">&#39;台中市&#39;</span>: <span class="st">&#39;中臺灣&#39;</span>,</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>    ...:     <span class="st">&#39;彰化縣&#39;</span>: <span class="st">&#39;中臺灣&#39;</span>,</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>    ...:     <span class="st">&#39;南投縣&#39;</span>: <span class="st">&#39;中臺灣&#39;</span>,</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>    ...:     <span class="st">&#39;雲林縣&#39;</span>: <span class="st">&#39;中臺灣&#39;</span>,</span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>    ...:     <span class="st">&#39;嘉義市&#39;</span>: <span class="st">&#39;南臺灣&#39;</span>,</span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>    ...:     <span class="st">&#39;嘉義縣&#39;</span>: <span class="st">&#39;南臺灣&#39;</span>,</span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>    ...:     <span class="st">&#39;台南市&#39;</span>: <span class="st">&#39;南臺灣&#39;</span>,</span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>    ...:     <span class="st">&#39;高雄市&#39;</span>: <span class="st">&#39;南臺灣&#39;</span>,</span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>    ...:     <span class="st">&#39;屏東縣&#39;</span>: <span class="st">&#39;南臺灣&#39;</span>,</span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>    ...:     <span class="st">&#39;澎湖縣&#39;</span>: <span class="st">&#39;南臺灣&#39;</span>,</span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a>    ...:     <span class="st">&#39;連江縣&#39;</span>: <span class="st">&#39;金馬&#39;</span>,</span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a>    ...:     <span class="st">&#39;金門縣&#39;</span>: <span class="st">&#39;金馬&#39;</span>}</span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">63</span>]: district <span class="op">=</span> pd.DataFrame({<span class="st">&#39;縣市&#39;</span>: area.keys(),</span>
<span id="cb50-26"><a href="#cb50-26" aria-hidden="true" tabindex="-1"></a>    ...:                          <span class="st">&#39;區域&#39;</span>: area.values()})</span>
<span id="cb50-27"><a href="#cb50-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-28"><a href="#cb50-28" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">64</span>]: district.head()</span>
<span id="cb50-29"><a href="#cb50-29" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">64</span>]:</span>
<span id="cb50-30"><a href="#cb50-30" aria-hidden="true" tabindex="-1"></a>    縣市    區域</span>
<span id="cb50-31"><a href="#cb50-31" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>  花蓮縣  東台灣</span>
<span id="cb50-32"><a href="#cb50-32" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>  台東縣  東台灣</span>
<span id="cb50-33"><a href="#cb50-33" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>  基隆市  北台灣</span>
<span id="cb50-34"><a href="#cb50-34" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>  台北市  北台灣</span>
<span id="cb50-35"><a href="#cb50-35" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>  新北市  北台灣</span></code></pre></div>
<p>接下來我們就利用「縣市」這一共通欄位進行合併。</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">65</span>]: covid_has_area <span class="op">=</span> pd.merge(covid, district, how<span class="op">=</span><span class="st">&#39;left&#39;</span>, on<span class="op">=</span><span class="st">&#39;縣市&#39;</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">66</span>]: covid_has_area.sample(<span class="dv">5</span>)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">66</span>]:</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>           確定病名       個案研判日   縣市    鄉鎮  性別  是否為境外移入    年齡層  確定病例數      區域</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="dv">6428</span>  嚴重特殊傳染性肺炎  <span class="dv">2021</span><span class="op">/</span><span class="dv">06</span><span class="op">/</span><span class="dv">03</span>  新北市  五股區  女       否             <span class="dv">5</span><span class="op">-</span><span class="dv">9</span>      <span class="dv">1</span>        北台灣</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="dv">2662</span>  嚴重特殊傳染性肺炎  <span class="dv">2021</span><span class="op">/</span><span class="dv">05</span><span class="op">/</span><span class="dv">23</span>  台北市  中正區  女       否           <span class="dv">50</span><span class="op">-</span><span class="dv">54</span>      <span class="dv">1</span>        北台灣</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="dv">786</span>   嚴重特殊傳染性肺炎  <span class="dv">2021</span><span class="op">/</span><span class="dv">03</span><span class="op">/</span><span class="dv">15</span>   空值    空值   男       是           <span class="dv">25</span><span class="op">-</span><span class="dv">29</span>      <span class="dv">1</span>         NaN</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="dv">8212</span>  嚴重特殊傳染性肺炎  <span class="dv">2021</span><span class="op">/</span><span class="dv">06</span><span class="op">/</span><span class="dv">11</span>  桃園市  八德區  男       否           <span class="dv">55</span><span class="op">-</span><span class="dv">59</span>      <span class="dv">1</span>        北台灣</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a><span class="dv">8063</span>  嚴重特殊傳染性肺炎  <span class="dv">2021</span><span class="op">/</span><span class="dv">06</span><span class="op">/</span><span class="dv">10</span>  新北市  三峽區  女       否           <span class="dv">30</span><span class="op">-</span><span class="dv">34</span>      <span class="dv">1</span>        北台灣</span></code></pre></div>
<p>接下來我們就能用區域的觀點進行後續分析啦！</p>
<p>這邊我們用的是 left 的合併方式，也就是只看左邊表格（這裡是 covid ）的鍵值。若有個鍵值只有右邊表格（ district ）有則會被忽略。</p>
<!-- JOIN WAYS -->
<p>更詳細使用 <code class="sourceCode python">pandas.merge</code> 函式的方式請洽 <a href="https://pandas.pydata.org/docs/reference/api/pandas.merge.html">API 頁面</a>。</p>
</section>
</section>
</section>
<section id="聽說-pandas-對時間日期的分析很方便" class="level2">
<h2>聽說 Pandas 對時間日期的分析很方便？</h2>
<p>Pandas 提供 <code class="sourceCode python">pandas.Timestamp</code> 類型來紀錄時間日期。我們 covid 表格的「個案研判日」目前還是字串，得先把它用 <a href="https://pandas.pydata.org/docs/reference/api/pandas.to_datetime.html"><code class="sourceCode python">pandas.to_datetime</code></a> 函式轉換過去。</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">67</span>]: covid[<span class="st">&#39;個案研判日&#39;</span>] <span class="op">=</span> pd.to_datetime(covid[<span class="st">&#39;個案研判日&#39;</span>])</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">68</span>]: covid.head()</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">68</span>]:</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>        確定病名      個案研判日  縣市  鄉鎮 性別 是否為境外移入    年齡層  確定病例數</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>  嚴重特殊傳染性肺炎 <span class="dv">2020</span><span class="op">-</span><span class="dv">01</span><span class="op">-</span><span class="dv">22</span>  空值  空值  女       是         <span class="dv">55</span><span class="op">-</span><span class="dv">59</span>      <span class="dv">1</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>  嚴重特殊傳染性肺炎 <span class="dv">2020</span><span class="op">-</span><span class="dv">01</span><span class="op">-</span><span class="dv">24</span>  空值  空值  女       是         <span class="dv">50</span><span class="op">-</span><span class="dv">54</span>      <span class="dv">1</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>  嚴重特殊傳染性肺炎 <span class="dv">2020</span><span class="op">-</span><span class="dv">01</span><span class="op">-</span><span class="dv">24</span>  空值  空值  男       是         <span class="dv">55</span><span class="op">-</span><span class="dv">59</span>      <span class="dv">1</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>  嚴重特殊傳染性肺炎 <span class="dv">2020</span><span class="op">-</span><span class="dv">01</span><span class="op">-</span><span class="dv">26</span>  空值  空值  女       是         <span class="dv">55</span><span class="op">-</span><span class="dv">59</span>      <span class="dv">1</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>  嚴重特殊傳染性肺炎 <span class="dv">2020</span><span class="op">-</span><span class="dv">01</span><span class="op">-</span><span class="dv">27</span>  空值  空值  女       是         <span class="dv">50</span><span class="op">-</span><span class="dv">54</span>      <span class="dv">1</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">69</span>]: covid.info()</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span><span class="kw">class</span> <span class="st">&#39;pandas.core.frame.DataFrame&#39;</span><span class="op">&gt;</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>RangeIndex: <span class="dv">11004</span> entries, <span class="dv">0</span> to <span class="dv">11003</span></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>Data columns (total <span class="dv">8</span> columns):</span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a> <span class="co">#   Column          Non-Null Count  Dtype</span></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a><span class="op">---</span>  <span class="op">------</span>          <span class="op">--------------</span>  <span class="op">-----</span></span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a> <span class="dv">0</span>   確定病名        <span class="dv">11004</span> non<span class="op">-</span>null  <span class="bu">object</span></span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span>   個案研判日      <span class="dv">11004</span> non<span class="op">-</span>null  datetime64[ns]</span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span>   縣市            <span class="dv">11004</span> non<span class="op">-</span>null  <span class="bu">object</span></span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span>   鄉鎮            <span class="dv">11004</span> non<span class="op">-</span>null  <span class="bu">object</span></span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span>   性別            <span class="dv">11004</span> non<span class="op">-</span>null  <span class="bu">object</span></span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span>   是否為境外移入  <span class="dv">11004</span> non<span class="op">-</span>null  <span class="bu">object</span></span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span>   年齡層          <span class="dv">11004</span> non<span class="op">-</span>null  <span class="bu">object</span></span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span>   確定病例數      <span class="dv">11004</span> non<span class="op">-</span>null  int64</span>
<span id="cb52-26"><a href="#cb52-26" aria-hidden="true" tabindex="-1"></a>dtypes: datetime64[ns](<span class="dv">1</span>), int64(<span class="dv">1</span>), <span class="bu">object</span>(<span class="dv">6</span>)</span>
<span id="cb52-27"><a href="#cb52-27" aria-hidden="true" tabindex="-1"></a>memory usage: <span class="fl">687.9</span><span class="op">+</span> KB</span></code></pre></div>
<details>
<summary onmouseover="this.style=&#39;background-color:#deeefc;&#39;" onmouseout="this.style=&#39;background-color:none;&#39;">
也可以在讀入的時候就轉換
</summary>
<div class="sourceCode" id="cb53"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">70</span>]: covid <span class="op">=</span> pd.read_csv(<span class="st">&#39;data/Day_Confirmation_Age_County_Gender_19CoV.csv&#39;</span>, parse_dates<span class="op">=</span>[<span class="st">&quot;個案研判日&quot;</span>])</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">70</span>]:</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>            確定病名      個案研判日   縣市    鄉鎮  性別 是否為境外移入    年齡層  確定病例數</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>      嚴重特殊傳染性肺炎 <span class="dv">2020</span><span class="op">-</span><span class="dv">01</span><span class="op">-</span><span class="dv">22</span>   空值    空值   女       是            <span class="dv">55</span><span class="op">-</span><span class="dv">59</span>      <span class="dv">1</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>      嚴重特殊傳染性肺炎 <span class="dv">2020</span><span class="op">-</span><span class="dv">01</span><span class="op">-</span><span class="dv">24</span>   空值    空值   女       是            <span class="dv">50</span><span class="op">-</span><span class="dv">54</span>      <span class="dv">1</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>      嚴重特殊傳染性肺炎 <span class="dv">2020</span><span class="op">-</span><span class="dv">01</span><span class="op">-</span><span class="dv">24</span>   空值    空值   男       是            <span class="dv">55</span><span class="op">-</span><span class="dv">59</span>      <span class="dv">1</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>      嚴重特殊傳染性肺炎 <span class="dv">2020</span><span class="op">-</span><span class="dv">01</span><span class="op">-</span><span class="dv">26</span>   空值    空值   女       是            <span class="dv">55</span><span class="op">-</span><span class="dv">59</span>      <span class="dv">1</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>      嚴重特殊傳染性肺炎 <span class="dv">2020</span><span class="op">-</span><span class="dv">01</span><span class="op">-</span><span class="dv">27</span>   空值    空值   女       是            <span class="dv">50</span><span class="op">-</span><span class="dv">54</span>      <span class="dv">1</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>...          ...        ...  ...  ... ..     ...    ...    ...</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a><span class="dv">10999</span>  嚴重特殊傳染性肺炎 <span class="dv">2021</span><span class="op">-</span><span class="dv">07</span><span class="op">-</span><span class="dv">22</span>  新北市  板橋區  男       否            <span class="dv">25</span><span class="op">-</span><span class="dv">29</span>      <span class="dv">1</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a><span class="dv">11000</span>  嚴重特殊傳染性肺炎 <span class="dv">2021</span><span class="op">-</span><span class="dv">07</span><span class="op">-</span><span class="dv">22</span>  新北市  板橋區  男       否            <span class="dv">30</span><span class="op">-</span><span class="dv">34</span>      <span class="dv">1</span></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a><span class="dv">11001</span>  嚴重特殊傳染性肺炎 <span class="dv">2021</span><span class="op">-</span><span class="dv">07</span><span class="op">-</span><span class="dv">22</span>  新北市  泰山區  男       否            <span class="dv">45</span><span class="op">-</span><span class="dv">49</span>      <span class="dv">1</span></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a><span class="dv">11002</span>  嚴重特殊傳染性肺炎 <span class="dv">2021</span><span class="op">-</span><span class="dv">07</span><span class="op">-</span><span class="dv">22</span>  新北市  淡水區  男       否            <span class="dv">35</span><span class="op">-</span><span class="dv">39</span>      <span class="dv">1</span></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a><span class="dv">11003</span>  嚴重特殊傳染性肺炎 <span class="dv">2021</span><span class="op">-</span><span class="dv">07</span><span class="op">-</span><span class="dv">22</span>  新北市  樹林區  女       否            <span class="dv">35</span><span class="op">-</span><span class="dv">39</span>      <span class="dv">1</span></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>[<span class="dv">11004</span> rows x <span class="dv">8</span> columns]</span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">71</span>]: covid.info()</span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span><span class="kw">class</span> <span class="st">&#39;pandas.core.frame.DataFrame&#39;</span><span class="op">&gt;</span></span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a>RangeIndex: <span class="dv">11004</span> entries, <span class="dv">0</span> to <span class="dv">11003</span></span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>Data columns (total <span class="dv">8</span> columns):</span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a> <span class="co">#   Column          Non-Null Count  Dtype</span></span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a><span class="op">---</span>  <span class="op">------</span>          <span class="op">--------------</span>  <span class="op">-----</span></span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a> <span class="dv">0</span>   確定病名        <span class="dv">11004</span> non<span class="op">-</span>null  <span class="bu">object</span></span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span>   個案研判日      <span class="dv">11004</span> non<span class="op">-</span>null  datetime64[ns]</span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span>   縣市            <span class="dv">11004</span> non<span class="op">-</span>null  <span class="bu">object</span></span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span>   鄉鎮            <span class="dv">11004</span> non<span class="op">-</span>null  <span class="bu">object</span></span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span>   性別            <span class="dv">11004</span> non<span class="op">-</span>null  <span class="bu">object</span></span>
<span id="cb53-29"><a href="#cb53-29" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span>   是否為境外移入  <span class="dv">11004</span> non<span class="op">-</span>null  <span class="bu">object</span></span>
<span id="cb53-30"><a href="#cb53-30" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span>   年齡層          <span class="dv">11004</span> non<span class="op">-</span>null  <span class="bu">object</span></span>
<span id="cb53-31"><a href="#cb53-31" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span>   確定病例數      <span class="dv">11004</span> non<span class="op">-</span>null  int64</span>
<span id="cb53-32"><a href="#cb53-32" aria-hidden="true" tabindex="-1"></a>dtypes: datetime64[ns](<span class="dv">1</span>), int64(<span class="dv">1</span>), <span class="bu">object</span>(<span class="dv">6</span>)</span>
<span id="cb53-33"><a href="#cb53-33" aria-hidden="true" tabindex="-1"></a>memory usage: <span class="fl">687.9</span><span class="op">+</span> KB</span></code></pre></div>
</details>
<p>如此一來，我們就把「個案研判日」這一欄轉換成 <code class="sourceCode python">pandas.Timestamp</code> 。這時候我們就可以利用 <a href="https://pandas.pydata.org/docs/reference/series.html#api-series-dt"><code class="sourceCode python">Series.dt</code> 的一系列方法</a> 進行時間日期專門的相關操作了。</p>
<section id="依照時間頻率重整表格" class="level4">
<h4>依照時間頻率重整表格</h4>
<p>假如我們對日期解析度的要求沒這麼高，也許一個月統計一次就好，我們可以：</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">72</span>]: covid[<span class="st">&#39;month&#39;</span>] <span class="op">=</span> covid.個案研判日.dt.month</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">73</span>]: covid.sample(<span class="dv">5</span>)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">73</span>]:</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>           確定病名      個案研判日   縣市   鄉鎮   性別 是否為境外移入      年齡層   確定病例數  month</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="dv">5604</span>  嚴重特殊傳染性肺炎 <span class="dv">2021</span><span class="op">-</span><span class="dv">06</span><span class="op">-</span><span class="dv">01</span>  台北市  大同區  男       否            <span class="dv">20</span><span class="op">-</span><span class="dv">24</span>      <span class="dv">1</span>         <span class="dv">6</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="dv">6842</span>  嚴重特殊傳染性肺炎 <span class="dv">2021</span><span class="op">-</span><span class="dv">06</span><span class="op">-</span><span class="dv">04</span>  新北市  蘆洲區  男       否            <span class="dv">45</span><span class="op">-</span><span class="dv">49</span>      <span class="dv">1</span>         <span class="dv">6</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a><span class="dv">1902</span>  嚴重特殊傳染性肺炎 <span class="dv">2021</span><span class="op">-</span><span class="dv">05</span><span class="op">-</span><span class="dv">20</span>  台北市  北投區  男       否            <span class="dv">40</span><span class="op">-</span><span class="dv">44</span>      <span class="dv">1</span>         <span class="dv">5</span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a><span class="dv">1999</span>  嚴重特殊傳染性肺炎 <span class="dv">2021</span><span class="op">-</span><span class="dv">05</span><span class="op">-</span><span class="dv">20</span>  新北市  中和區  男       否            <span class="dv">25</span><span class="op">-</span><span class="dv">29</span>      <span class="dv">1</span>         <span class="dv">5</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a><span class="dv">8796</span>  嚴重特殊傳染性肺炎 <span class="dv">2021</span><span class="op">-</span><span class="dv">06</span><span class="op">-</span><span class="dv">14</span>  新北市  土城區  男       否            <span class="dv">20</span><span class="op">-</span><span class="dv">24</span>      <span class="dv">1</span>         <span class="dv">6</span></span></code></pre></div>
<p>又或者，你想知道是不是週末結束過後確診率會上升：</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">74</span>]: covid[<span class="st">&#39;weekday&#39;</span>] <span class="op">=</span> covid.個案研判日.dt.weekday</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">75</span>]: covid.groupby(covid.weekday).確定病例數.<span class="bu">sum</span>()</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">75</span>]:</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>weekday</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>    <span class="dv">2075</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>    <span class="dv">1833</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>    <span class="dv">2367</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>    <span class="dv">2402</span></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>    <span class="dv">2223</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>    <span class="dv">2669</span></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>    <span class="dv">1966</span></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>Name: 確定病例數, dtype: int64</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">76</span>]: covid.groupby(covid.weekday).確定病例數.<span class="bu">sum</span>().plot(kind<span class="op">=</span><span class="st">&#39;bar&#39;</span>)</span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">76</span>]: <span class="op">&lt;</span>AxesSubplot:xlabel<span class="op">=</span><span class="st">&#39;weekday&#39;</span><span class="op">&gt;</span></span></code></pre></div>
<p><img src="./media/weekday_count.jpg" /></p>
<p>禮拜一為 0 、禮拜日為 6 。禮拜六確診數量略高一些，但是沒有差太多。該不會是雖然有好好待在家，但好不容易放假，一放鬆免疫力下降？</p>
<p>我們的第一天和最後一天是哪天？</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">77</span>]: (covid.個案研判日.<span class="bu">max</span>(), covid.個案研判日.<span class="bu">min</span>())</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">77</span>]: (Timestamp(<span class="st">&#39;2021-07-22 00:00:00&#39;</span>), Timestamp(<span class="st">&#39;2020-01-22 00:00:00&#39;</span>))</span></code></pre></div>
<p>我們總共統計幾天？</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">78</span>]: covid.個案研判日.<span class="bu">max</span>() <span class="op">-</span> covid.個案研判日.<span class="bu">min</span>()</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">78</span>]: Timedelta(<span class="st">&#39;547 days 00:00:00&#39;</span>)</span></code></pre></div>
<details>
<summary onmouseover="this.style=&#39;background-color:#deeefc;&#39;" onmouseout="this.style=&#39;background-color:none;&#39;">
如果你看到的日期是一串奇怪的數字…例如「 2147483647 」
</summary>
<p>這個是 UNIX 時間，是從 1970 年 1 月 1 日 0 時 0 分 0 秒起至現在的總秒數，不考慮閏秒。</p>
<p>我們要正確使用這種時間要加 <code class="sourceCode python">unit<span class="op">=</span><span class="st">&quot;s&quot;</span></code> ：</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">79</span>]: pd.Timestamp(<span class="dv">2147483647</span>, unit<span class="op">=</span><span class="st">&#39;s&#39;</span>)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">79</span>]: Timestamp(<span class="st">&#39;2038-01-19 03:14:07&#39;</span>)</span></code></pre></div>
</details>
</section>
<section id="時間日期作為索引" class="level4">
<h4>時間日期作為索引</h4>
<p><code class="sourceCode python">pandas.Timestamp</code> 作為索引的時候（ <code class="sourceCode python">pandas.DatetimeIndex</code> 物件），我們可以很方便的調用一段時間的資料。<br />
例如說，不依賴 <code class="sourceCode python">.dt</code> 取得各資料列年份與星期幾索引值：</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">80</span>]: pivoted <span class="op">=</span> covid.pivot_table(index<span class="op">=</span>pd.to_datetime(covid.個案研判日), columns<span class="op">=</span><span class="st">&#39;是否為境外移入&#39;</span>, values<span class="op">=</span><span class="st">&#39;確定病例數&#39;</span>, aggfunc<span class="op">=</span><span class="st">&#39;sum&#39;</span>)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">81</span>]: (pivoted.index.year, pivoted.index.weekday)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">81</span>]:</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>(Int64Index([<span class="dv">2020</span>, <span class="dv">2020</span>, <span class="dv">2020</span>, <span class="dv">2020</span>, <span class="dv">2020</span>, <span class="dv">2020</span>, <span class="dv">2020</span>, <span class="dv">2020</span>, <span class="dv">2020</span>, <span class="dv">2020</span>,</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>             ...</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>             <span class="dv">2021</span>, <span class="dv">2021</span>, <span class="dv">2021</span>, <span class="dv">2021</span>, <span class="dv">2021</span>, <span class="dv">2021</span>, <span class="dv">2021</span>, <span class="dv">2021</span>, <span class="dv">2021</span>, <span class="dv">2021</span>],</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>            dtype<span class="op">=</span><span class="st">&#39;int64&#39;</span>, name<span class="op">=</span><span class="st">&#39;個案研判日&#39;</span>, length<span class="op">=</span><span class="dv">379</span>),</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a> Int64Index([<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">4</span>,</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>             ...</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>             <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>],</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>            dtype<span class="op">=</span><span class="st">&#39;int64&#39;</span>, name<span class="op">=</span><span class="st">&#39;個案研判日&#39;</span>, length<span class="op">=</span><span class="dv">379</span>))</span></code></pre></div>
<p>調用 2021 年 5 月 14 日後的資料（順便作圖）：</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">82</span>]: In [<span class="dv">46</span>]: pivoted[<span class="st">&#39;2021-05-14&#39;</span>:<span class="st">&#39;2021-05-31&#39;</span>].plot(kind<span class="op">=</span><span class="st">&#39;bar&#39;</span>,</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>    ...:                                                  figsize<span class="op">=</span>(<span class="dv">50</span>, <span class="dv">20</span>),</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>    ...:                                                  xlabel<span class="op">=</span><span class="st">&#39;&#39;</span>,</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>    ...:                                                  fontsize<span class="op">=</span><span class="dv">40</span>,</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>    ...:                                                  legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">82</span>]: <span class="op">&lt;</span>AxesSubplot:<span class="op">&gt;</span></span></code></pre></div>
<p><img src="./media/may-2021-situation.jpg" /></p>
<p>時間日期作為索引的時候，我們能更方便的調整資料取樣的間隔。<br />
統計到每個月月底，各年各月份最多確診數那天的確診量：</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">83</span>]: monthly_highest <span class="op">=</span> pivoted.resample(<span class="st">&#39;M&#39;</span>).<span class="bu">max</span>()</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">84</span>]: monthly_highest.head()</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">84</span>]:</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>是否為境外移入         否     是</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>個案研判日</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a><span class="dv">2020</span><span class="op">-</span><span class="dv">01</span><span class="op">-</span><span class="dv">31</span>           <span class="fl">1.0</span>   <span class="fl">2.0</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2020</span><span class="op">-</span><span class="dv">02</span><span class="op">-</span><span class="dv">29</span>           <span class="fl">4.0</span>   <span class="fl">3.0</span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a><span class="dv">2020</span><span class="op">-</span><span class="dv">03</span><span class="op">-</span><span class="dv">31</span>           <span class="fl">3.0</span>  <span class="fl">25.0</span></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a><span class="dv">2020</span><span class="op">-</span><span class="dv">04</span><span class="op">-</span><span class="dv">30</span>           <span class="fl">2.0</span>  <span class="fl">22.0</span></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a><span class="dv">2020</span><span class="op">-</span><span class="dv">05</span><span class="op">-</span><span class="dv">31</span>           NaN   <span class="fl">3.0</span></span></code></pre></div>
<p>相關的手法請參照 <a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.resample.html"><code class="sourceCode python">Series.resample</code></a> ，上面 <code class="sourceCode python">resample</code> 裡的 <code class="sourceCode python"><span class="co">&#39;M&#39;</span></code> 是個用來標記時間間隔的代號，可用的代號<a href="https://pandas.pydata.org/docs/user_guide/timeseries.html#offset-aliases">請參考這邊</a>。</p>
</section>
</section>
<section id="文字資料也能輕鬆操作" class="level2">
<h2>文字資料也能輕鬆操作？</h2>
<p><code class="sourceCode python">Series</code> 可以利用 <a href="https://pandas.pydata.org/docs/reference/series.html#string-handling"><code class="sourceCode python">.<span class="bu">str</span></code> 的一系列方法</a>來統一操作整欄的字串。Pandas 的這系列方法揉合了標準函式庫和 <code class="sourceCode python">re</code> 模組。其方法包含搜尋用的 <code class="sourceCode python">contains</code> 、 <code class="sourceCode python">startwith</code> 、 <code class="sourceCode python">extract</code> ；操作文字的 <code class="sourceCode python">lower</code> 、<code class="sourceCode python">replace</code> 、 <code class="sourceCode python">strip</code> ；測試文字的 <code class="sourceCode python">isdigit</code> 、<code class="sourceCode python">isspace</code> 等等。</p>
<p>比如說，我想知道所有的縣和包含「台北」兩字地區的確診數，第一步我可以：</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">85</span>]: covid[covid.縣市.<span class="bu">str</span>.contains(<span class="st">&#39;縣|台北&#39;</span>)]</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">85</span>]:</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>            確定病名      個案研判日   縣市   鄉鎮   性別 是否為境外移入    年齡層  確定病例數</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>      嚴重特殊傳染性肺炎 <span class="dv">2020</span><span class="op">-</span><span class="dv">01</span><span class="op">-</span><span class="dv">28</span>  彰化縣  和美鎮  男       否            <span class="dv">50</span><span class="op">-</span><span class="dv">54</span>      <span class="dv">1</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span>      嚴重特殊傳染性肺炎 <span class="dv">2020</span><span class="op">-</span><span class="dv">01</span><span class="op">-</span><span class="dv">30</span>  南投縣  南投市  女       否            <span class="dv">40</span><span class="op">-</span><span class="dv">44</span>      <span class="dv">1</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a><span class="dv">17</span>     嚴重特殊傳染性肺炎 <span class="dv">2020</span><span class="op">-</span><span class="dv">02</span><span class="op">-</span><span class="dv">16</span>  彰化縣  彰化市  男       否            <span class="dv">55</span><span class="op">-</span><span class="dv">59</span>      <span class="dv">1</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="dv">18</span>     嚴重特殊傳染性肺炎 <span class="dv">2020</span><span class="op">-</span><span class="dv">02</span><span class="op">-</span><span class="dv">16</span>  彰化縣  彰化市  男       否            <span class="dv">60</span><span class="op">-</span><span class="dv">64</span>      <span class="dv">1</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a><span class="dv">20</span>     嚴重特殊傳染性肺炎 <span class="dv">2020</span><span class="op">-</span><span class="dv">02</span><span class="op">-</span><span class="dv">18</span>  彰化縣  彰化市  女       否              <span class="dv">70</span><span class="op">+</span>      <span class="dv">1</span></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>...          ...        ...  ...  ... ..     ...    ...    ...</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a><span class="dv">10951</span>  嚴重特殊傳染性肺炎 <span class="dv">2021</span><span class="op">-</span><span class="dv">07</span><span class="op">-</span><span class="dv">21</span>  台北市  萬華區  男       否            <span class="dv">35</span><span class="op">-</span><span class="dv">39</span>      <span class="dv">1</span></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a><span class="dv">10983</span>  嚴重特殊傳染性肺炎 <span class="dv">2021</span><span class="op">-</span><span class="dv">07</span><span class="op">-</span><span class="dv">22</span>  台北市  大安區  男       否            <span class="dv">45</span><span class="op">-</span><span class="dv">49</span>      <span class="dv">2</span></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a><span class="dv">10984</span>  嚴重特殊傳染性肺炎 <span class="dv">2021</span><span class="op">-</span><span class="dv">07</span><span class="op">-</span><span class="dv">22</span>  台北市  中正區  男       否            <span class="dv">20</span><span class="op">-</span><span class="dv">24</span>      <span class="dv">1</span></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a><span class="dv">10985</span>  嚴重特殊傳染性肺炎 <span class="dv">2021</span><span class="op">-</span><span class="dv">07</span><span class="op">-</span><span class="dv">22</span>  台北市  中正區  男       否            <span class="dv">30</span><span class="op">-</span><span class="dv">34</span>      <span class="dv">1</span></span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a><span class="dv">10986</span>  嚴重特殊傳染性肺炎 <span class="dv">2021</span><span class="op">-</span><span class="dv">07</span><span class="op">-</span><span class="dv">22</span>  宜蘭縣  礁溪鄉  男       否            <span class="dv">30</span><span class="op">-</span><span class="dv">34</span>      <span class="dv">1</span></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>[<span class="dv">3945</span> rows x <span class="dv">8</span> columns]</span></code></pre></div>
<p>雖然這邊這樣做很沒有意義，但是我們可以發現，我們可以在 <code class="sourceCode python">contains</code> 方法中使用正則表達式（ regular expression ）。事實上，Pandas 裡 <code class="sourceCode python">.<span class="bu">str</span></code> 的所有查找方法都可以用正則表達式來代替寫死的文字。</p>
<p>又比如說，這是我剛剛從維基百科上複製下來的 <a href="https://en.wikipedia.org/wiki/2020_in_film#Award_ceremonies">2020 年電影頒獎典禮</a>列表：</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">86</span>]: movie_ceres <span class="op">=</span> pd.read_clipboard()</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">87</span>]: movie_ceres.head()</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">87</span>]:</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>         Date                            Event                                 Host                             Location</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>   January <span class="dv">5</span>         <span class="dv">77</span>th Golden Globe Awards  Hollywood Foreign Press Association  Beverly Hills, California, U.S.[<span class="dv">33</span>]</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>  January <span class="dv">11</span>       <span class="dv">3</span>rd Zee Cine Awards Telugu        Zee Entertainment Enterprises      Hyderabad, Telangana, India[<span class="dv">34</span>]</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>  January <span class="dv">12</span>       <span class="dv">25</span>th Critics Choice Awards   Broadcast Film Critics Association       Santa Monica, California, U.S.</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>  January <span class="dv">19</span>  <span class="dv">26</span>th Screen Actors Guild Awards                            SAG<span class="op">-</span>AFTRA        Los Angeles, California, U.S.</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>  January <span class="dv">20</span>            <span class="dv">55</span>th Guldbagge Awards               Swedish Film Institute                Stockholm, Sweden[<span class="dv">35</span>]</span></code></pre></div>
<p>我想將第幾屆從 Event 分開來，並放到 Event 的後面：</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">88</span>]: movie_ceres.insert(<span class="dv">2</span>,</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>     ...:                    column<span class="op">=</span><span class="st">&#39;nth&#39;</span>,</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>     ...:                    value<span class="op">=</span>[i[<span class="dv">0</span>] <span class="cf">for</span> i <span class="kw">in</span> movie_ceres.Event.<span class="bu">str</span>.split(<span class="st">&#39; &#39;</span>)])</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">89</span>]: movie_ceres.Event <span class="op">=</span> [<span class="st">&#39; &#39;</span>.join(i[<span class="dv">1</span>:]) <span class="cf">for</span> i <span class="kw">in</span> movie_ceres.Event.<span class="bu">str</span>.split(<span class="st">&#39; &#39;</span>)]</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">90</span>]: movie_ceres.head()</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">90</span>]:</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>         Date                       Event   nth                                 Host                             Location</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>   January <span class="dv">5</span>         Golden Globe Awards  <span class="dv">77</span>th  Hollywood Foreign Press Association  Beverly Hills, California, U.S.[<span class="dv">33</span>]</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>  January <span class="dv">11</span>      Zee Cine Awards Telugu   <span class="dv">3</span>rd        Zee Entertainment Enterprises      Hyderabad, Telangana, India[<span class="dv">34</span>]</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>  January <span class="dv">12</span>       Critics Choice Awards  <span class="dv">25</span>th   Broadcast Film Critics Association       Santa Monica, California, U.S.</span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>  January <span class="dv">19</span>  Screen Actors Guild Awards  <span class="dv">26</span>th                            SAG<span class="op">-</span>AFTRA        Los Angeles, California, U.S.</span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>  January <span class="dv">20</span>            Guldbagge Awards  <span class="dv">55</span>th               Swedish Film Institute                Stockholm, Sweden[<span class="dv">35</span>]</span></code></pre></div>
<p>Host 我希望是小寫：</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">91</span>]: movie_ceres.Host <span class="op">=</span> movie_ceres.Host.<span class="bu">str</span>.lower()</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">92</span>]: movie_ceres.head()</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">92</span>]:</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>         Date                       Event   nth                                 Host                             Location</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>   January <span class="dv">5</span>         Golden Globe Awards  <span class="dv">77</span>th  hollywood foreign press association  Beverly Hills, California, U.S.[<span class="dv">33</span>]</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>  January <span class="dv">11</span>      Zee Cine Awards Telugu   <span class="dv">3</span>rd        zee entertainment enterprises      Hyderabad, Telangana, India[<span class="dv">34</span>]</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>  January <span class="dv">12</span>       Critics Choice Awards  <span class="dv">25</span>th   broadcast film critics association       Santa Monica, California, U.S.</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>  January <span class="dv">19</span>  Screen Actors Guild Awards  <span class="dv">26</span>th                            sag<span class="op">-</span>aftra        Los Angeles, California, U.S.</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>  January <span class="dv">20</span>            Guldbagge Awards  <span class="dv">55</span>th               swedish film institute                Stockholm, Sweden[<span class="dv">35</span>]</span></code></pre></div>
<p>我想知道主辦單位名字最長的那場是什麼：</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">93</span>]: movie_ceres.iloc[movie_ceres.Host.<span class="bu">str</span>.<span class="bu">len</span>().idxmax()]</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">93</span>]:</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>Date                                                  June <span class="dv">29</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>Event                                          Platino Awards</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>nth                                                       <span class="dv">7</span>th</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>Host        entidad de gestión de derechos de los producto...</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>Location                                  Panama City, Panama</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>Name: <span class="dv">15</span>, dtype: <span class="bu">object</span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">94</span>]: movie_ceres.iloc[movie_ceres.Host.<span class="bu">str</span>.<span class="bu">len</span>().idxmax()].Host</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">94</span>]: <span class="st">&#39;entidad de gestión de derechos de los productores audiovisuales&#39;</span></span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">95</span>]: <span class="bu">len</span>(movie_ceres.iloc[movie_ceres.Host.<span class="bu">str</span>.<span class="bu">len</span>().idxmax()].Host)</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">95</span>]: <span class="dv">63</span></span></code></pre></div>
<p>原來是西班牙「 entidad de gestión de derechos de los productores audiovisuales 」辦在巴拿馬的 Platino Awards 啊！主辦單位全名共 55 個字行政相當不方便吧？</p>
<p>再回到我們的 covid 表，如果我要一次把「性別」欄位的男、女改成代號「 M, F 」：</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">96</span>]: covid.性別 <span class="op">=</span> covid.性別.replace({<span class="st">&#39;男&#39;</span>: <span class="st">&#39;M&#39;</span>, <span class="st">&#39;女&#39;</span>: <span class="st">&#39;F&#39;</span>})</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">97</span>]: covid.head()</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">97</span>]:</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>        確定病名      個案研判日  縣市  鄉鎮 性別 是否為境外移入    年齡層  確定病例數</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>  嚴重特殊傳染性肺炎 <span class="dv">2020</span><span class="op">-</span><span class="dv">01</span><span class="op">-</span><span class="dv">22</span>  空值  空值  F       是          <span class="dv">55</span><span class="op">-</span><span class="dv">59</span>      <span class="dv">1</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>  嚴重特殊傳染性肺炎 <span class="dv">2020</span><span class="op">-</span><span class="dv">01</span><span class="op">-</span><span class="dv">24</span>  空值  空值  F       是          <span class="dv">50</span><span class="op">-</span><span class="dv">54</span>      <span class="dv">1</span></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>  嚴重特殊傳染性肺炎 <span class="dv">2020</span><span class="op">-</span><span class="dv">01</span><span class="op">-</span><span class="dv">24</span>  空值  空值  M       是          <span class="dv">55</span><span class="op">-</span><span class="dv">59</span>      <span class="dv">1</span></span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>  嚴重特殊傳染性肺炎 <span class="dv">2020</span><span class="op">-</span><span class="dv">01</span><span class="op">-</span><span class="dv">26</span>  空值  空值  F       是          <span class="dv">55</span><span class="op">-</span><span class="dv">59</span>      <span class="dv">1</span></span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>  嚴重特殊傳染性肺炎 <span class="dv">2020</span><span class="op">-</span><span class="dv">01</span><span class="op">-</span><span class="dv">27</span>  空值  空值  F       是          <span class="dv">50</span><span class="op">-</span><span class="dv">54</span>      <span class="dv">1</span></span></code></pre></div>
<p>反倒請使用 <code class="sourceCode python">Series</code> 的 <code class="sourceCode python">replace</code> 方法。<code class="sourceCode python">Series</code> 的 <code class="sourceCode python">replace</code> 能接受一個字典值，其鍵為更改之前、值為更改之後。可以一次大量的更改許多不同的情況。除非是有些許差異的字串要改成同一串文字，這個 <code class="sourceCode python">.<span class="bu">str</span></code> 可以用正則表達式做的很好，否則能一一對應、分別指定值的 <code class="sourceCode python">Series.replace</code> 方便一些。</p>
</section>
<section id="你可能還會想看" class="level2">
<h2>你可能還會想看…</h2>
<ul>
<li>官方使用手冊
<ul>
<li><a href="https://pandas.pydata.org/docs/getting_started/intro_tutorials/index.html">快速上手指引</a> — 我這篇抄這裡的。寫的相當親民，再去看看也能再學到東西</li>
<li><a href="https://pandas.pydata.org/docs/getting_started/intro_tutorials/index.html">使用者手冊</a> — 更詳盡的說明書。對任何主題有任何疑問都可以先去看看，保證不虛此行</li>
<li><a href="https://pandas.pydata.org/docs/getting_started/intro_tutorials/index.html">API 參考手冊</a> — 不知道某個函式或方法或什麼詳細使用方式的最佳參考書，技術者的最愛</li>
</ul></li>
<li>Data School （影片） — Kevin Markham
<ul>
<li><a href="https://youtu.be/dPwLlJkSHLo">Data Science Best Practices with pandas</a> — 2019 年在 PyCon 2019 的演講，手把手教你怎麼資料分析</li>
<li><a href="https://youtu.be/RlIiVeig3hc">My top 25 pandas tricks</a> — 雖然是標準 YTer 釣魚標題，不過裡面是完全不廢話的滿滿好用小技巧</li>
</ul></li>
<li><a href="https://github.com/guipsamora/pandas_exercises">Pandas Exercises</a> — 在 Github 上的 guipsamora 收集了許多題目讓大家練手</li>
</ul>
<p>以上就是 Pandas 走馬看花的介紹，希望大家能在這其中學到點什麼，又或是得到點什麼樣的樂趣。</p>
<p>本文到此結束。我們有緣，再見。</p>
</section>
<script src="scripts/floating-toc.js" type="text/javascript"></script>
</body>
</html>
